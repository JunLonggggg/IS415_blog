<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>IS415 Web Blog: Take Home Exercise 2</title>

<meta property="description" itemprop="description" content="A short description of the post."/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-09-20"/>
<meta property="article:created" itemprop="dateCreated" content="2021-09-20"/>
<meta name="article:author" content="Toh Jun Long"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="IS415 Web Blog: Take Home Exercise 2"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A short description of the post."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="IS415 Web Blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="IS415 Web Blog: Take Home Exercise 2"/>
<meta property="twitter:description" content="A short description of the post."/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Take Home Exercise 2"]},{"type":"character","attributes":{},"value":["A short description of the post."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Toh Jun Long"]},{"type":"character","attributes":{},"value":["https://linkedin.com/in/tohjunlong"]}]}]},{"type":"character","attributes":{},"value":["09-20-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/aspatial/Airbnb_listing/29062021.csv","data/aspatial/Airbnb_listing/30062019.csv","data/aspatial/OneMap_Data/hotels.csv","data/aspatial/OneMap_Data/tourism.csv","data/geospatial/CostalOutline.dbf","data/geospatial/CostalOutline.prj","data/geospatial/CostalOutline.sbn","data/geospatial/CostalOutline.sbx","data/geospatial/CostalOutline.shp","data/geospatial/CostalOutline.shx","data/geospatial/MP14_SUBZONE_WEB_PL.dbf","data/geospatial/MP14_SUBZONE_WEB_PL.prj","data/geospatial/MP14_SUBZONE_WEB_PL.sbn","data/geospatial/MP14_SUBZONE_WEB_PL.sbx","data/geospatial/MP14_SUBZONE_WEB_PL.shp","data/geospatial/MP14_SUBZONE_WEB_PL.shp.xml","data/geospatial/MP14_SUBZONE_WEB_PL.shx","data/geospatial/MRTLRTStnPtt.CPG","data/geospatial/MRTLRTStnPtt.dbf","data/geospatial/MRTLRTStnPtt.prj","data/geospatial/MRTLRTStnPtt.sbn","data/geospatial/MRTLRTStnPtt.sbx","data/geospatial/MRTLRTStnPtt.shp","data/geospatial/MRTLRTStnPtt.shp.xml","data/geospatial/MRTLRTStnPtt.shx","take-home-exercise-2_files/anchor-4.2.2/anchor.min.js","take-home-exercise-2_files/bowser-1.9.3/bowser.min.js","take-home-exercise-2_files/distill-2.2.21/template.v2.js","take-home-exercise-2_files/figure-html5/unnamed-chunk-10-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-100-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-102-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-103-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-105-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-106-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-112-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-119-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-120-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-121-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-122-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-126-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-136-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-137-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-138-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-142-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-147-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-148-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-149-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-15-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-150-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-155-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-158-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-159-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-160-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-161-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-165-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-166-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-168-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-169-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-171-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-172-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-175-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-176-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-178-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-179-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-181-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-182-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-184-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-186-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-187-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-189-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-190-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-192-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-193-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-195-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-196-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-198-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-199-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-201-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-21-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-22-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-23-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-24-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-27-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-28-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-29-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-34-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-35-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-36-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-51-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-52-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-53-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-54-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-55-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-56-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-57-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-58-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-59-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-60-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-61-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-62-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-63-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-64-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-65-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-66-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-67-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-68-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-77-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-78-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-81-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-82-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-83-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-84-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-85-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-87-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-92-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-93-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-94-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-95-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-96-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-97-1.png","take-home-exercise-2_files/figure-html5/unnamed-chunk-99-1.png","take-home-exercise-2_files/header-attrs-2.10/header-attrs.js","take-home-exercise-2_files/htmlwidgets-1.5.3/htmlwidgets.js","take-home-exercise-2_files/jquery-1.11.3/jquery.min.js","take-home-exercise-2_files/jquery-1.12.4/jquery.min.js","take-home-exercise-2_files/leaflet-1.3.1/images/layers-2x.png","take-home-exercise-2_files/leaflet-1.3.1/images/layers.png","take-home-exercise-2_files/leaflet-1.3.1/images/marker-icon-2x.png","take-home-exercise-2_files/leaflet-1.3.1/images/marker-icon.png","take-home-exercise-2_files/leaflet-1.3.1/images/marker-shadow.png","take-home-exercise-2_files/leaflet-1.3.1/leaflet.css","take-home-exercise-2_files/leaflet-1.3.1/leaflet.js","take-home-exercise-2_files/leaflet-binding-2.0.4.1/leaflet.js","take-home-exercise-2_files/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js","take-home-exercise-2_files/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js","take-home-exercise-2_files/Leaflet.Sync-0.0.5/bower.json","take-home-exercise-2_files/Leaflet.Sync-0.0.5/L.Map.Sync.js","take-home-exercise-2_files/Leaflet.Sync-0.0.5/LICENSE","take-home-exercise-2_files/leafletfix-1.0.0/leafletfix.css","take-home-exercise-2_files/popper-2.6.0/popper.min.js","take-home-exercise-2_files/proj4-2.6.2/proj4.min.js","take-home-exercise-2_files/Proj4Leaflet-1.0.1/proj4leaflet.js","take-home-exercise-2_files/rstudio_leaflet-1.3.1/images/1px.png","take-home-exercise-2_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css","take-home-exercise-2_files/tippy-6.2.7/tippy-bundle.umd.min.js","take-home-exercise-2_files/tippy-6.2.7/tippy-light-border.css","take-home-exercise-2_files/tippy-6.2.7/tippy.css","take-home-exercise-2_files/tippy-6.2.7/tippy.umd.min.js","take-home-exercise-2_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.10/header-attrs.js"></script>
  <script src="../../site_libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
  <script src="../../site_libs/jquery-1.12.4/jquery.min.js"></script>
  <link href="../../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
  <script src="../../site_libs/leaflet-1.3.1/leaflet.js"></script>
  <link href="../../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
  <script src="../../site_libs/proj4-2.6.2/proj4.min.js"></script>
  <script src="../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
  <link href="../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
  <script src="../../site_libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
  <script src="../../site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
  <script src="../../site_libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
  <script src="../../site_libs/Leaflet.Sync-0.0.5/L.Map.Sync.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Take Home Exercise 2","description":"A short description of the post.","authors":[{"author":"Toh Jun Long","authorURL":"https://linkedin.com/in/tohjunlong","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-09-20T00:00:00.000+08:00","citationText":"Long, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">IS415 Web Blog</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<div class="nav-dropdown">
<button class="nav-dropbtn">
In-class Exercise
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../posts/2021-08-23-in-class-exercise-2/index.html">In-Class Exercise 2</a>
<a href="../../posts/2021-09-03-in-class-exercise-3/index.html">In-Class Exercise 3</a>
<a href="../../posts/2021-09-06-in-class-exercise-4/index.html">In-Class Exercise 4</a>
<a href="../../posts/2021-09-13-in-class-exercise-5/index.html">In-Class Exercise 5</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Take-home Exercise
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../posts/2021-09-06-take-home-exercise-1/index.html">Take-home Exercise 1</a>
<span class="nav-dropdown-header">Take-home Exercise 2</span>
<span class="nav-dropdown-header">Take-home Exercise 3</span>
</div>
</div>
<a href="../../about.html">About</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Take Home Exercise 2</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>A short description of the post.</p></p>
</div>

<div class="d-byline">
  Toh Jun Long <a href="https://linkedin.com/in/tohjunlong" class="uri">https://linkedin.com/in/tohjunlong</a> 
  
<br/>09-20-2021
</div>

<div class="d-article">
<p>1.0.0 Context and analysis goal(s):</p>
<p>1.1.o Contexts Due to the ever-changing world, people all around the world are able to set up simple, small scale business operations within the comfort of our home. Our analysis will focus on Airbnb, the leading short-term rentals. While it is not legal to make short-term rentals, enforcement of such legal policy would be rare.</p>
<p>1.2.0 Analysis Goals:</p>
<ul>
<li>Main goal: To determine if distribution of Airbnb listings are affected by factors such as as existing hotels, public transport options and other notable amenities</li>
</ul>
<p>1.2.1 Exploratory Spatial Data Analysis</p>
<ul>
<li>Derive kernel density maps of Airbnb listings, hotel, MRT services and tourist attractions.</li>
<li>Display kernel density maps on openstreetmap of Singapore. Describe the spatial patterns derived from the kernel density maps.</li>
</ul>
<p>1.2.2 Second-Order Spatial Point Patterns Analysis (2nd order SPPA)</p>
<ul>
<li>Formulate null and alternative hypothesis, select confidence level</li>
<li>perform tests using 2nd order SPPA technique</li>
<li>Draw statistical conclusions</li>
</ul>
<ol start="2" type="1">
<li>Understanding the Dataset</li>
</ol>
<p>2.1 Airbnb listings</p>
<p>Datas: Aspatial + Airbnb listing at 30th June 2019: 30062019.csv + Airbnb listing at 29th June 2021: 29062021.csv + Tourisms Spots: tourism.csv + Hotels: hotels.csv</p>
<p>Geospatial + Train Stations: MRTLRTStnPtt.shp + Coastal Outline: CostalOutline.shp + Singapore Planning Subzones: MP14_SUBZONE_WEB_PL.shp</p>
<p>Sources: + <a href="http://insideairbnb.com/get-the-data.html" class="uri">http://insideairbnb.com/get-the-data.html</a> + <a href="https://cran.r-project.org/web/packages/onemapsgapi/index.html" class="uri">https://cran.r-project.org/web/packages/onemapsgapi/index.html</a> + <a href="https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=mrt%20stations" class="uri">https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=mrt%20stations</a></p>
<ol start="3" type="1">
<li>Importing Required Packages</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>packages</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"maptools"</span>,<span class='st'>"sf"</span>,<span class='st'>"raster"</span>,<span class='st'>"spatstat"</span>,<span class='st'>"tmap"</span>,<span class='st'>"tidyverse"</span>, <span class='st'>"plotly"</span>,<span class='st'>"ggthemes"</span>, <span class='st'>'sp'</span>, <span class='st'>'rgdal'</span>, <span class='st'>'spNetwork'</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>, character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
      <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Importing datas</li>
</ol>
<p>4.1 importing Geospatial data</p>
<p>4.1.1. importing train station shp file</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>train_station</span> <span class='op'>=</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"data/geospatial"</span>,
                        layer <span class='op'>=</span> <span class='st'>"MRTLRTStnPtt"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Reading layer `MRTLRTStnPtt&#39; from data source 
  `C:\JunLonggggg\junlong-is415\_posts\2021-09-20-take-home-exercise-2\data\geospatial&#39; 
  using driver `ESRI Shapefile&#39;
Simple feature collection with 171 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6138.311 ymin: 27555.06 xmax: 45254.86 ymax: 47854.2
Projected CRS: SVY21</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>train_station</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS[&quot;SVY21&quot;,
    BASEGEOGCRS[&quot;SVY21[WGS84]&quot;,
        DATUM[&quot;World Geodetic System 1984&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]],
            ID[&quot;EPSG&quot;,6326]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433]]],
    CONVERSION[&quot;unnamed&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;(E)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]],
        AXIS[&quot;(N)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]]]</code></pre>
</div>
<p>Reading in the Planning Subzone Geospatial data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mpsz</span> <span class='op'>=</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"data/geospatial"</span>,
               layer <span class='op'>=</span> <span class='st'>"MP14_SUBZONE_WEB_PL"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Reading layer `MP14_SUBZONE_WEB_PL&#39; from data source 
  `C:\JunLonggggg\junlong-is415\_posts\2021-09-20-take-home-exercise-2\data\geospatial&#39; 
  using driver `ESRI Shapefile&#39;
Simple feature collection with 323 features and 15 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
Projected CRS: SVY21</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>mpsz</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS[&quot;SVY21&quot;,
    BASEGEOGCRS[&quot;SVY21[WGS84]&quot;,
        DATUM[&quot;World Geodetic System 1984&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]],
            ID[&quot;EPSG&quot;,6326]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433]]],
    CONVERSION[&quot;unnamed&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;(E)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]],
        AXIS[&quot;(N)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]]]</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sg_sf</span> <span class='op'>=</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"data/geospatial"</span>,
                layer <span class='op'>=</span> <span class='st'>"CostalOutline"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Reading layer `CostalOutline&#39; from data source 
  `C:\JunLonggggg\junlong-is415\_posts\2021-09-20-take-home-exercise-2\data\geospatial&#39; 
  using driver `ESRI Shapefile&#39;
Simple feature collection with 60 features and 4 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 2663.926 ymin: 16357.98 xmax: 56047.79 ymax: 50244.03
Projected CRS: SVY21</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>sg_sf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS[&quot;SVY21&quot;,
    BASEGEOGCRS[&quot;SVY21[WGS84]&quot;,
        DATUM[&quot;World Geodetic System 1984&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]],
            ID[&quot;EPSG&quot;,6326]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433]]],
    CONVERSION[&quot;unnamed&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;(E)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]],
        AXIS[&quot;(N)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]]]</code></pre>
</div>
<p>Setting the projected coordinate system to Singapores standard projection system of 3414.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>train_station_3414</span> <span class='op'>=</span> <span class='fu'>st_set_crs</span><span class='op'>(</span><span class='va'>train_station</span>, <span class='fl'>3414</span><span class='op'>)</span>
<span class='va'>mpsz_3414</span> <span class='op'>=</span> <span class='fu'>st_set_crs</span><span class='op'>(</span><span class='va'>mpsz</span>, <span class='fl'>3414</span><span class='op'>)</span>
<span class='va'>sg_sf_3414</span> <span class='op'>=</span> <span class='fu'>st_set_crs</span><span class='op'>(</span><span class='va'>sg_sf</span>, <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>To check if the change is successful:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>sg_sf_3414</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: EPSG:3414 
  wkt:
PROJCRS[&quot;SVY21 / Singapore TM&quot;,
    BASEGEOGCRS[&quot;SVY21&quot;,
        DATUM[&quot;SVY21&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4757]],
    CONVERSION[&quot;Singapore Transverse Mercator&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,1.36666666666667,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,103.833333333333,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,1,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,28001.642,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,38744.572,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;northing (N)&quot;,north,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;easting (E)&quot;,east,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;Cadastre, engineering survey, topographic mapping.&quot;],
        AREA[&quot;Singapore - onshore and offshore.&quot;],
        BBOX[1.13,103.59,1.47,104.07]],
    ID[&quot;EPSG&quot;,3414]]</code></pre>
</div>
<p>Doing a plot to show the spatial points illustrating the mrt stations in the subzones</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>train_station_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span>,
          size <span class='op'>=</span> <span class='fl'>0.125</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-10-1.png" width="624" /></p>
</div>
<p>Reading in the Aspatial data.</p>
<p>Airbnb Datas:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021</span> <span class='op'>=</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/aspatial/Airbnb_listing/29062021.csv"</span><span class='op'>)</span>
<span class='va'>airbnb_2019</span> <span class='op'>=</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/aspatial/Airbnb_listing/30062019.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>OneMaps Datas:</p>
<p>Hotel:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hotels</span> <span class='op'>=</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/aspatial/OneMap_Data/hotels.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Tourism spots:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tourism</span> <span class='op'>=</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/aspatial/OneMap_Data/tourism.csv"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>LATITUDE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Transforming latitude and longitude of each aspatial data to Singapore projection system</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_sf</span> <span class='op'>=</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>airbnb_2019</span>,
                          coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"longitude"</span>,<span class='st'>"latitude"</span><span class='op'>)</span>,
                          crs <span class='op'>=</span> <span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
<span class='va'>airbnb_2021_sf</span> <span class='op'>=</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>airbnb_2021</span>,
                          coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"longitude"</span>,<span class='st'>"latitude"</span><span class='op'>)</span>,
                          crs <span class='op'>=</span> <span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
<span class='va'>hotels_sf</span> <span class='op'>=</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hotels</span>,
                     coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Lng"</span>,<span class='st'>"Lat"</span><span class='op'>)</span>,
                     crs <span class='op'>=</span> <span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
<span class='va'>tourism_sf</span> <span class='op'>=</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>tourism</span>,
                     coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGTITUDE"</span>,<span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                     crs <span class='op'>=</span> <span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="section-a-airbnb-distribution-in-2019">Section A: Airbnb Distribution in 2019</h2>
<h3 id="exploratory-spatial-data-analysis">Exploratory Spatial Data Analysis</h3>
<p>First let us plot the spatial points of each dataset onto the map (mpsz) to look at the spread of Airbnb Listings, Hotels, Tourism Spots and Mrt Stations</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_map</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>airbnb_2019_sf</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span>,
          col <span class='op'>=</span> <span class='st'>"#CC0033"</span><span class='op'>)</span>
<span class='va'>hotel_map</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>hotels_sf</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span>,
          col <span class='op'>=</span> <span class='st'>"#0066CC"</span><span class='op'>)</span>
<span class='va'>tourism_map</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>tourism_sf</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span>,
          col <span class='op'>=</span> <span class='st'>"#FF6600"</span><span class='op'>)</span>
<span class='va'>train_station_map</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>train_station_3414</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span>,
        size <span class='op'>=</span> <span class='fl'>0.05</span>,
        col <span class='op'>=</span> <span class='st'>"#00940c"</span><span class='op'>)</span>
<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>airbnb_2019_map</span>, <span class='va'>hotel_map</span>, <span class='va'>tourism_map</span>,<span class='va'>train_station_map</span>,ncol <span class='op'>=</span> <span class='fl'>2</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<p>From the map, we can vaguely tell that there are higher concentation of airbnb listing along the southern central part of the island, where Sentosa and other recreational activities are commonly found in Singapore, as illustrated by the orange spatial points for Tourism and blue spatial points for hotels.</p>
<p>This is merely a visual gauge of the concentration, thus we should calculate the count and density of airbnb listings, hotels and tourisms spots in each planning area.</p>
<p>We shall now move to plot the kernel density for each of the 4 spatial points dataset available. i.e.Airbnb listing, mrt station, tourism and hotels.</p>
<h3 id="geospatial-data-wrangling">Geospatial data wrangling</h3>
<h4 id="converting-sf-data-frames-to-sps-spatial-class">1. Converting sf data frames to sps Spatial* class</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019</span> <span class='op'>=</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>airbnb_2019_sf</span><span class='op'>)</span>
<span class='va'>train_station</span> <span class='op'>=</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>train_station_3414</span><span class='op'>)</span>
<span class='va'>tourism</span> <span class='op'>=</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>tourism_sf</span><span class='op'>)</span>
<span class='va'>hotels</span> <span class='op'>=</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>hotels_sf</span><span class='op'>)</span>
<span class='va'>sg</span> <span class='op'>=</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>sg_sf_3414</span><span class='op'>)</span>
<span class='va'>mpsz</span> <span class='op'>=</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>To confirm if the conversion to Spatial* class was successful</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019</span>
</code></pre>
</div>
<pre><code>class       : SpatialPointsDataFrame 
features    : 8293 
extent      : 7215.566, 44098.31, 25166.35, 49226.35  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 14
names       :       id,                                              name,   host_id,                host_name, neighbourhood_group, neighbourhood,       room_type, price, minimum_nights, number_of_reviews, last_review, reviews_per_month, calculated_host_listings_count, availability_365 
min values  :    49091,                                                 -,     23666, (Email hidden by Airbnb),      Central Region,    Ang Mo Kio, Entire home/apt,     0,              1,                 0,       15656,              0.01,                              1,                0 
max values  : 36053005, ZR2- NEW! Sunny &amp; Modern Apt 4 mins to Orchard Rd, 271165196,                   Zuzana,         West Region,        Yishun,     Shared room, 13999,           1000,               308,       18072,             12.09,                            277,              365 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>train_station</span>
</code></pre>
</div>
<pre><code>class       : SpatialPointsDataFrame 
features    : 171 
extent      : 6138.311, 45254.86, 27555.06, 47854.2  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 3
names       : OBJECTID,              STN_NAME, STN_NO 
min values  :        1, ADMIRALTY MRT STATION,    BP1 
max values  :      199,    YISHUN MRT STATION,    TE8 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tourism</span>
</code></pre>
</div>
<pre><code>class       : SpatialPointsDataFrame 
features    : 106 
extent      : 11380.23, 43659.54, 22869.34, 47596.73  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 15
names       :                                NAME,                                                                                                                                                  DESCRIPTION,                  ADDRESSSTREETNAME,                            HYPERLINK,                                                                                                                             PHOTOURL,                                                                                          URL_PATH,                                                                                                          IMAGE_ALT_TEXT,                 PHOTOCREDITS,   LASTMODIFIED,                                                                                             META_DESCRIPTION,                                                                                                                                                                           OPENING_HOURS,              Lat,              Lng,        ICON_NAME, ADDRESSPOSTALCODE 
min values  : Adventure Cove Waterpark Singapore, A feat of engineering, an architectural statement and a sheer aesthetic triumph, Marina Bay Sands&lt;sup&gt;&lt;/sup&gt; has upped the ante for buildings in Singapore.,                       1 Beach Road,                   http://acm.org.sg/,                                  /content/dam/desktop/global/see-do-singapore/architecture/hajjah-fatimah-mosque-carousel01-rect.jpg, www.yoursingapore.com/en/see-do-singapore/architecture/historical/capitol-building-singapore.html,               Adults and kids of all ages who are not even science buffs will have fun at the Singapore Science Centre., Darren Soh/National Gallery, 1427691447.648, A tranquil patch of imperial China in the west of Singapore is pleasant respite from the bustle of the city.,                                                                                                                                                 50th storey Skybridge, Daily, 9am 10pm, 1.22309649975255, 103.683980000372, tourist_spot.gif,                 0 
max values  :          Victoria Theatre Singapore,                                                    With so many attractions packed into this 15-km stretch of beaches, youll never run out of things to do., Seng Poh Road and Tiong Bahru Road, https://www.pub.gov.sg/marinabarrage, www.yoursingapore.com/content/dam/desktop/global/see-do-singapore/recreation-leisure/universal-studios-singapore-carousel01-rect.jpg,      www.yoursingapore.com/en/see-do-singapore/recreation-leisure/viewpoints/singapore-flyer.html, Whether you prefer water sports, rollerblading or cycling, find a myriad of things to do at East Coast Park, Singapore.,  Wildlife Reserves Singapore, 1446544541.364,                                     With the Henderson Waves bridge, form meets function to stunning effect., Visits are by appointment only.Visitors must sign up in advance for heritage tours which fall on:Monday, 2pm  3pm,Tuesday, 6.30pm  7.30pm,Thursday, 10am  11am,Saturday, 11am  12pm, 1.44672000006097, 103.974030000359, tourist_spot.gif,                 0 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hotels</span>
</code></pre>
</div>
<pre><code>class       : SpatialPointsDataFrame 
features    : 422 
extent      : 5939.241, 45334.18, 25379.44, 44562.4  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 7
names       :                              NAME, ADDRESSPOSTALCODE,                                 ADDRESSSTREETNAME,         HYPERLINK, TOTALROOMS,     KEEPERNAME, ICON_NAME 
min values  :                      30 BENCOOLEN,             18956,                                 1 Bayfront Avenue, 96ytlim@gmail.com,          4,  Adel Aramouni, hotel.gif 
max values  : YotelAir Singapore Changi Airport,            819666, 99 IRRAWADDY ROAD, # 22-00 ROYAL SQUARE AT NOVENA, zubair@dam.com.sg,       2561, Zhang YuanQing, hotel.gif </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sg</span>
</code></pre>
</div>
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 60 
extent      : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 4
names       : GDO_GID, MSLINK, MAPID,              COSTAL_NAM 
min values  :       1,      1,     0,             ISLAND LINK 
max values  :      60,     67,     0, SINGAPORE - MAIN ISLAND </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mpsz</span>
</code></pre>
</div>
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 323 
extent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 15
names       : OBJECTID, SUBZONE_NO, SUBZONE_N, SUBZONE_C, CA_IND, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C,          INC_CRC, FMEL_UPD_D,     X_ADDR,     Y_ADDR,    SHAPE_Leng,    SHAPE_Area 
min values  :        1,          1, ADMIRALTY,    AMSZ01,      N, ANG MO KIO,         AM, CENTRAL REGION,       CR, 00F5E30B5C9B7AD8,      16409,  5092.8949,  19579.069, 871.554887798, 39437.9352703 
max values  :      323,         17,    YUNNAN,    YSSZ09,      Y,     YISHUN,         YS,    WEST REGION,       WR, FFCCF172717C2EAF,      16409, 50424.7923, 49552.7904, 68083.9364708,  69748298.792 </code></pre>
</div>
<h4 id="converting-spatial-class-into-generic-sp-format">2. Converting Spatial* class into generic sp format</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_sp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>airbnb_2019</span>,<span class='st'>"SpatialPoints"</span><span class='op'>)</span>
<span class='va'>train_station_sp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>train_station</span>,<span class='st'>"SpatialPoints"</span><span class='op'>)</span>
<span class='va'>tourism_sp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>tourism</span>,<span class='st'>"SpatialPoints"</span><span class='op'>)</span>
<span class='va'>hotels_sp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>hotels</span>,<span class='st'>"SpatialPoints"</span><span class='op'>)</span>
<span class='va'>sg_sp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>sg</span>, <span class='st'>"SpatialPolygons"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_sp</span>
</code></pre>
</div>
<pre><code>class       : SpatialPoints 
features    : 8293 
extent      : 7215.566, 44098.31, 25166.35, 49226.35  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>train_station_sp</span>
</code></pre>
</div>
<pre><code>class       : SpatialPoints 
features    : 171 
extent      : 6138.311, 45254.86, 27555.06, 47854.2  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tourism_sp</span>
</code></pre>
</div>
<pre><code>class       : SpatialPoints 
features    : 106 
extent      : 11380.23, 43659.54, 22869.34, 47596.73  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hotels_sp</span>
</code></pre>
</div>
<pre><code>class       : SpatialPoints 
features    : 422 
extent      : 5939.241, 45334.18, 25379.44, 44562.4  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </code></pre>
</div>
<h4 id="converting-sp-format-into-spatstats-ppp-format">3. Converting sp format into spatstats ppp format</h4>
<p>Airbnb 2019:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_ppp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>airbnb_2019_sp</span>,<span class='st'>"ppp"</span><span class='op'>)</span>
<span class='va'>airbnb_2019_ppp</span>
</code></pre>
</div>
<pre><code>Planar point pattern: 8293 points
window: rectangle = [7215.57, 44098.31] x [25166.35, 49226.35] units</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-29-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>airbnb_2019_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Planar point pattern:  8293 points
Average intensity 9.345289e-06 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [7215.57, 44098.31] x [25166.35, 49226.35] units
                    (36880 x 24060 units)
Window area = 887399000 square units</code></pre>
</div>
<p>based on the above output, we can tell that there is duplicated points and thus should identify and handle them as necessary.</p>
<p>To confirm:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>airbnb_2019_ppp</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] TRUE</code></pre>
</div>
<p>To check the number of locations with duplicated points.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>multiplicity</span><span class='op'>(</span><span class='va'>airbnb_2019_ppp</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 6</code></pre>
</div>
<p>We will use the jittering solution to handle the duplicates, since any drop of data could potentially mean loss of useful information.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_ppp_jit</span> <span class='op'>=</span><span class='fu'>rjitter</span><span class='op'>(</span><span class='va'>airbnb_2019_ppp</span>,
                             retry <span class='op'>=</span> <span class='cn'>TRUE</span>,
                             nsim <span class='op'>=</span> <span class='fl'>1</span>,
                             drop <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>airbnb_2019_ppp_jit</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
</div>
<p>We have successfully ensure that all locations do not have duplicated points for the airbnb ppp object.</p>
<p>Now to convert and check the other sp objects for duplicated values, as unlikely as it is.</p>
<p>train station:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>train_station_ppp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>train_station_sp</span>,<span class='st'>"ppp"</span><span class='op'>)</span>
<span class='va'>train_station_ppp</span>
</code></pre>
</div>
<pre><code>Planar point pattern: 171 points
window: rectangle = [6138.31, 45254.86] x [27555.06, 47854.2] units</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>train_station_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-36-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>train_station_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Planar point pattern:  171 points
Average intensity 2.153565e-07 points per square unit

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [6138.31, 45254.86] x [27555.06, 47854.2] units
                    (39120 x 20300 units)
Window area = 794032000 square units</code></pre>
</div>
<p>No duplicates for train stations.</p>
<p>Tourism:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tourism_ppp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>tourism_sp</span>,<span class='st'>"ppp"</span><span class='op'>)</span>
<span class='va'>tourism_ppp</span>
</code></pre>
</div>
<pre><code>Planar point pattern: 106 points
window: rectangle = [11380.23, 43659.54] x [22869.34, 47596.73] units</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>tourism_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Planar point pattern:  106 points
Average intensity 1.328016e-07 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [11380.23, 43659.54] x [22869.34, 47596.73] units
                    (32280 x 24730 units)
Window area = 798183000 square units</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>tourism_ppp</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] TRUE</code></pre>
</div>
<p>Checking the number of duplicated points:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>multiplicity</span><span class='op'>(</span><span class='va'>tourism_ppp</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 7</code></pre>
</div>
<p>Again, We will use the jittering solution to handle the duplicates, since any drop of data could potentially mean loss of useful information.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tourism_ppp_jit</span> <span class='op'>=</span><span class='fu'>rjitter</span><span class='op'>(</span><span class='va'>tourism_ppp</span>,
                             retry <span class='op'>=</span> <span class='cn'>TRUE</span>,
                             nsim <span class='op'>=</span> <span class='fl'>1</span>,
                             drop <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>tourism_ppp_jit</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
</div>
<p>Lastly, Hotels:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hotels_ppp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>hotels_sp</span>,<span class='st'>"ppp"</span><span class='op'>)</span>
<span class='va'>hotels_ppp</span>
</code></pre>
</div>
<pre><code>Planar point pattern: 422 points
window: rectangle = [5939.24, 45334.18] x [25379.44, 44562.4] units</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>hotels_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Planar point pattern:  422 points
Average intensity 5.58414e-07 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [5939.24, 45334.18] x [25379.44, 44562.4] units
                    (39390 x 19180 units)
Window area = 755712000 square units</code></pre>
</div>
<p>duplicated points are detected.</p>
<p>To confirm:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>hotels_ppp</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] TRUE</code></pre>
</div>
<p>Checking the number of duplicated points:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>multiplicity</span><span class='op'>(</span><span class='va'>hotels_ppp</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 10</code></pre>
</div>
<p>Again, We will use the jittering solution to handle the duplicates.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hotels_ppp_jit</span> <span class='op'>=</span><span class='fu'>rjitter</span><span class='op'>(</span><span class='va'>hotels_ppp</span>,
                             retry <span class='op'>=</span> <span class='cn'>TRUE</span>,
                             nsim <span class='op'>=</span> <span class='fl'>1</span>,
                             drop <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>hotels_ppp_jit</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
</div>
<p>Now all ppp objects will not have any overlappiing spatial points.</p>
<h3 id="creating-owin-object">Creating owin object</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sg_owin</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>sg_sp</span>, <span class='st'>"owin"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sg_owin</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Window: polygonal boundary
60 separate polygons (no holes)
            vertices        area relative.area
polygon 1         38 1.56140e+04      2.09e-05
polygon 2        735 4.69093e+06      6.27e-03
polygon 3         49 1.66986e+04      2.23e-05
polygon 4         76 3.12332e+05      4.17e-04
polygon 5       5141 6.36179e+08      8.50e-01
polygon 6         42 5.58317e+04      7.46e-05
polygon 7         67 1.31354e+06      1.75e-03
polygon 8         15 4.46420e+03      5.96e-06
polygon 9         14 5.46674e+03      7.30e-06
polygon 10        37 5.26194e+03      7.03e-06
polygon 11        53 3.44003e+04      4.59e-05
polygon 12        74 5.82234e+04      7.78e-05
polygon 13        69 5.63134e+04      7.52e-05
polygon 14       143 1.45139e+05      1.94e-04
polygon 15       165 3.38736e+05      4.52e-04
polygon 16       130 9.40465e+04      1.26e-04
polygon 17        19 1.80977e+03      2.42e-06
polygon 18        16 2.01046e+03      2.69e-06
polygon 19        93 4.30642e+05      5.75e-04
polygon 20        90 4.15092e+05      5.54e-04
polygon 21       721 1.92795e+06      2.57e-03
polygon 22       330 1.11896e+06      1.49e-03
polygon 23       115 9.28394e+05      1.24e-03
polygon 24        37 1.01705e+04      1.36e-05
polygon 25        25 1.66227e+04      2.22e-05
polygon 26        10 2.14507e+03      2.86e-06
polygon 27       190 2.02489e+05      2.70e-04
polygon 28       175 9.25904e+05      1.24e-03
polygon 29      1993 9.99217e+06      1.33e-02
polygon 30        38 2.42492e+04      3.24e-05
polygon 31        24 6.35239e+03      8.48e-06
polygon 32        53 6.35791e+05      8.49e-04
polygon 33        41 1.60161e+04      2.14e-05
polygon 34        22 2.54368e+03      3.40e-06
polygon 35        30 1.08382e+04      1.45e-05
polygon 36       327 2.16921e+06      2.90e-03
polygon 37       111 6.62927e+05      8.85e-04
polygon 38        90 1.15991e+05      1.55e-04
polygon 39        98 6.26829e+04      8.37e-05
polygon 40       415 3.25384e+06      4.35e-03
polygon 41       222 1.51142e+06      2.02e-03
polygon 42       107 6.33039e+05      8.45e-04
polygon 43         7 2.48299e+03      3.32e-06
polygon 44        17 3.28303e+04      4.38e-05
polygon 45        26 8.34758e+03      1.11e-05
polygon 46       177 4.67446e+05      6.24e-04
polygon 47        16 3.19460e+03      4.27e-06
polygon 48        15 4.87296e+03      6.51e-06
polygon 49        66 1.61841e+04      2.16e-05
polygon 50       149 5.63430e+06      7.53e-03
polygon 51       609 2.62570e+07      3.51e-02
polygon 52         8 7.82256e+03      1.04e-05
polygon 53       976 2.33447e+07      3.12e-02
polygon 54        55 8.25379e+04      1.10e-04
polygon 55       976 2.33447e+07      3.12e-02
polygon 56        61 3.33449e+05      4.45e-04
polygon 57         6 1.68410e+04      2.25e-05
polygon 58         4 9.45963e+03      1.26e-05
polygon 59        46 6.99702e+05      9.35e-04
polygon 60        13 7.00873e+04      9.36e-05
enclosing rectangle: [2663.93, 56047.79] x [16357.98, 50244.03] units
                     (53380 x 33890 units)
Window area = 748741000 square units
Fraction of frame area: 0.414</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>sg_owin</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-52-1.png" width="624" /></p>
</div>
<h3 id="combining-the-point-events-objects-with-the-owin-object">combining the point events objects with the owin object</h3>
<h4 id="airbnb-2019">Airbnb 2019</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_SG_ppp_jit</span>  <span class='op'>=</span> <span class='va'>airbnb_2019_ppp_jit</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_SG_ppp_jit</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-54-1.png" width="624" /></p>
</div>
<h4 id="train-station">Train Station</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>train_station_SG_ppp</span>  <span class='op'>=</span> <span class='va'>train_station_ppp</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>train_station_SG_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-56-1.png" width="624" /></p>
</div>
<h4 id="tourism">Tourism</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tourism_SG_ppp_jit</span>  <span class='op'>=</span> <span class='va'>tourism_ppp_jit</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>tourism_SG_ppp_jit</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-58-1.png" width="624" /></p>
</div>
<h4 id="hotels">Hotels</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hotels_SG_ppp_jit</span>  <span class='op'>=</span> <span class='va'>hotels_ppp_jit</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>hotels_SG_ppp_jit</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-60-1.png" width="624" /></p>
</div>
<h3 id="kde">KDE</h3>
<p>For the KDEs, the following settings are used: + adaptive bandwidth: since the airbnb distribution showed signs of clustering in the previous point plots.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive</span> <span class='op'>=</span> <span class='fu'>adaptive.density</span><span class='op'>(</span><span class='va'>airbnb_2019_SG_ppp_jit</span>, method<span class='op'>=</span><span class='st'>"kernel"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-61-1.png" width="624" /></p>
</div>
<p>From the kde plot for Airbnb listing 2019 above, we can see that the density range from 0 to 0.00175.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_train_station_SG_ppp_jit_adaptive</span> <span class='op'>=</span> <span class='fu'>adaptive.density</span><span class='op'>(</span><span class='va'>train_station_SG_ppp</span>, method<span class='op'>=</span><span class='st'>"kernel"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>kde_train_station_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-62-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_tourism_SG_ppp_jit_adaptive</span> <span class='op'>=</span> <span class='fu'>adaptive.density</span><span class='op'>(</span><span class='va'>tourism_SG_ppp_jit</span>, method<span class='op'>=</span><span class='st'>"kernel"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>kde_tourism_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-63-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_hotels_SG_ppp_jit_adaptive</span> <span class='op'>=</span> <span class='fu'>adaptive.density</span><span class='op'>(</span><span class='va'>hotels_SG_ppp_jit</span>, method<span class='op'>=</span><span class='st'>"kernel"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>kde_hotels_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-64-1.png" width="624" /></p>
</div>
<h4 id="converting-kde-output-into-grid-object">Converting KDE output into grid object</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gridded_kde_airbnb_2019_SG_ppp_jit_adaptive</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.im</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive</span><span class='op'>)</span>
<span class='fu'>spplot</span><span class='op'>(</span><span class='va'>gridded_kde_airbnb_2019_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-65-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gridded_kde_train_station_SG_ppp_jit_adaptive</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.im</span><span class='op'>(</span><span class='va'>kde_train_station_SG_ppp_jit_adaptive</span><span class='op'>)</span>
<span class='fu'>spplot</span><span class='op'>(</span><span class='va'>gridded_kde_train_station_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-66-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gridded_kde_tourism_SG_ppp_jit_adaptive</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.im</span><span class='op'>(</span><span class='va'>kde_tourism_SG_ppp_jit_adaptive</span><span class='op'>)</span>
<span class='fu'>spplot</span><span class='op'>(</span><span class='va'>gridded_kde_tourism_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-67-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gridded_kde_hotels_SG_ppp_jit_adaptive</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.im</span><span class='op'>(</span><span class='va'>kde_hotels_SG_ppp_jit_adaptive</span><span class='op'>)</span>
<span class='fu'>spplot</span><span class='op'>(</span><span class='va'>gridded_kde_hotels_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-68-1.png" width="624" /></p>
</div>
<h4 id="converting-grid-output-into-raster">Converting grid output into raster</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive_raster</span> <span class='op'>=</span> <span class='fu'>raster</span><span class='op'>(</span><span class='va'>gridded_kde_airbnb_2019_SG_ppp_jit_adaptive</span><span class='op'>)</span>
<span class='va'>kde_train_station_SG_ppp_jit_adaptive_raster</span> <span class='op'>=</span> <span class='fu'>raster</span><span class='op'>(</span><span class='va'>gridded_kde_train_station_SG_ppp_jit_adaptive</span><span class='op'>)</span>
<span class='va'>kde_tourism_SG_ppp_jit_adaptive_raster</span> <span class='op'>=</span> <span class='fu'>raster</span><span class='op'>(</span><span class='va'>gridded_kde_tourism_SG_ppp_jit_adaptive</span><span class='op'>)</span>
<span class='va'>kde_hotels_SG_ppp_jit_adaptive_raster</span> <span class='op'>=</span> <span class='fu'>raster</span><span class='op'>(</span><span class='va'>gridded_kde_hotels_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : -5.553027e-21, 0.001658843  (min, max)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_train_station_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : 3.889546e-17, 2.812567e-06  (min, max)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_tourism_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : 3.959823e-09, 6.997935e-06  (min, max)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_hotels_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : 5.58487e-11, 3.847032e-05  (min, max)</code></pre>
</div>
<p>Setting back the crs/projection system information</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>projection</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+init=EPSG:3414"</span><span class='op'>)</span>
<span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs 
source     : memory
names      : v 
values     : -5.553027e-21, 0.001658843  (min, max)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>projection</span><span class='op'>(</span><span class='va'>kde_train_station_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+init=EPSG:3414"</span><span class='op'>)</span>
<span class='va'>kde_train_station_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs 
source     : memory
names      : v 
values     : 3.889546e-17, 2.812567e-06  (min, max)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>projection</span><span class='op'>(</span><span class='va'>kde_tourism_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+init=EPSG:3414"</span><span class='op'>)</span>
<span class='va'>kde_tourism_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs 
source     : memory
names      : v 
values     : 3.959823e-09, 6.997935e-06  (min, max)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>projection</span><span class='op'>(</span><span class='va'>kde_hotels_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+init=EPSG:3414"</span><span class='op'>)</span>
<span class='va'>kde_hotels_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs 
source     : memory
names      : v 
values     : 5.58487e-11, 3.847032e-05  (min, max)</code></pre>
</div>
<p>Displaying the raster on a map using tmap package</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='va'>airbnb_raster_map</span> <span class='op'>=</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>train_station_raster_map</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_train_station_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>tourism_raster_map</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_tourism_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>hotels_raster_map</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_hotels_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>airbnb_raster_map</span>,<span class='va'>train_station_raster_map</span>,<span class='va'>tourism_raster_map</span>,<span class='va'>hotels_raster_map</span>,ncol<span class='op'>=</span><span class='fl'>2</span>,nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-78-1.png" width="624" /></p>
</div>
<p>Using openstreetmap as the basemap</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"view"</span><span class='op'>)</span>
<span class='va'>airbnb_raster_map</span> <span class='op'>=</span> 
<span class='fu'>tm_basemap</span><span class='op'>(</span><span class='st'>"OpenStreetMap"</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span>, palette <span class='op'>=</span> <span class='st'>"Reds"</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>, <span class='st'>"bottom"</span><span class='op'>)</span>, frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>train_station_raster_map</span> <span class='op'>=</span> 
  <span class='fu'>tm_basemap</span><span class='op'>(</span><span class='st'>"OpenStreetMap"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_train_station_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span>, palette <span class='op'>=</span> <span class='st'>"Blues"</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>tourism_raster_map</span> <span class='op'>=</span>
  <span class='fu'>tm_basemap</span><span class='op'>(</span><span class='st'>"OpenStreetMap"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_tourism_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span>, palette <span class='op'>=</span> <span class='st'>"Greens"</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>hotels_raster_map</span> <span class='op'>=</span>
  <span class='fu'>tm_basemap</span><span class='op'>(</span><span class='st'>"OpenStreetMap"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_hotels_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span>, palette <span class='op'>=</span> <span class='st'>"Oranges"</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>airbnb_raster_map</span>,<span class='va'>train_station_raster_map</span>,<span class='va'>tourism_raster_map</span>,<span class='va'>hotels_raster_map</span>,ncol<span class='op'>=</span><span class='fl'>2</span>,nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<div style="display:inline;width:49%;float:left;border-style:solid;border-color:#BEBEBE;border-width:1px 1px 1px 1px;">
<div id="htmlwidget-7775" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-7775">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAE10lEQVR4nO2dy20kNxCGOSthA1EEOvvgDNaxOIA9bgCORSEoAEMRKJAFhPGpjQaHzWcVWSS/7yRh+sEm/67io7p4c+Ccc+7r8+N+9dvTy+utZ1l2g8p11wI8i+/r8+OOGHXYulJj1i8FgpRjy4psEZ8PYmzn2+gC9EZSgCDDVm+xlgCxhm2YrTypgUBPy4cY6zBVaSnBlDbyKNeLGMsw0yeUFgwCnAcTIswVjPRxWoy+/2wMfWslGsufUG69ngRYwzKGVZYVwWiACMsY4o5XFqBz6z9fitLn7/bG7tQwIUvI2vM16pWyk/icexRgTnBEKcc1VxG16kPsJsCDp5fXW86z14godN3ZxWhiimY1ek8lfX1+3LVfeM3rI8JOXFkrX0DH/5KNLnU9LSHijgeSmuM83HpMwKnrS3ULNPuhKiJEfLKkGr61vkf3KRHhJOQKpabulxMhApTFd6mtVnG04EKIFggB6pD7wdX5t5mmcp5HFwDSnMVVIiSrovPBEk7ILOLKhXnCCVntZccSTozk5w4jrSuWcGIkV1ZGGhAGJhtg3UOJmWDrD7oDV3GMEtfRZKrveqEPvUVInxAe6G1YECEE6SnEJrOLK16Xni65+TsH2ActYeKOIRtTkdVYwb2RtoiIEJqQEOQUqdbAFtKWkD4hDCdbhFhB0AJLCEVoTNMgQhgOIoThIELIZuiKCYMS0ARLCFloBjQQ3g9RekTTZGdjgv3oFc6FJRTg/v7mnHPu9udfg0siRyydiH9MK1hCyMYXppQILwcmPVLQrsb9/e1/q2gZa2lEst1xbtZPSNPTfbcI7urcoVE0Ty+vt95vkbW3NsYhqpA1/PePH8FjtUi11fH71XHDvzHJ2XtDIkVtLPljKtcezPWCxqgeHbe4Zz8h+HEdX5TsgvTIivVhYoomtg2XdSt4dr1aLnZF4Z2p3pog99jYuan7zixOCVYX30FVAp3cxDujKrGHQO/vb6KWbxfBhajO4hQTYu2ebVINYcFK9lxxmJ2HPqGWq4u52tDAJHTcSqz6XDVUh3JdCSbHVfvHSDdIzwYOzQkisDKy9ua9onZjl9AaZIvbuhK5tEX3+4G/f/7tvv/6J3oOU01pVIJaY+vOPSag1XKmeAORlACPsiDAOEWWsGQ3yNi5LZardsfLkSDCOM/OyW7+3PO8M1cuXXKp0Ud6mmZXiqZopBJzl1C6weBByz7BtZzLivXLx8SyXYqaBk1FkBx/SwsS8ZXT7Wu7nNCiXmWpvW8q/AnqKApqrb3J+dzYdIymhYqRO7fpdwsINZPhcnQsuW9a6Ho5QhxBqA6slnUVgqNjjcrN6bBba1S/zFg8HYJrx70LYUl8oe5Ci4eANENHx1YbNNZv3SnIohcPld1SoS1hYJYhHEuXhyka+j3QG9F5wlWtQq/vb3dl+tRwZ8utmTVCOwZyZ7ImjkvR7rynJpI17gl6TG8JS0eyYI8uItQI3z8vm1mxeIi+jmWycl3lU+n5HFZehtlQ6RPuyvnDfOovnyniCS3DgKid511SamiC6Noo/kZ4Z3CzOpirUF6C/TDVwK2DpFB+w9h1sGw2MDNZLd0vpZ87D2ZEuHIaOYizlCuKhePjdgFgD2ZbagQASINl2wMzo2MfxAfDQYQAAAAAAAAAsA//ATTeaBPsCbZxAAAAAElFTkSuQmCC",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.498039215686275,null,"tmap401","kde_airbnb_2019_SG_ppp_jit_adaptive_raster"]},{"method":"addLegend","args":[{"colors":["#FDDED0","#FCA082","#F75A40","#CB181D"],"labels":["0.0000 to 0.0005","0.0005 to 0.0010","0.0010 to 0.0015","0.0015 to 0.0020"],"na_color":null,"na_label":"NA","opacity":0.498039215686275,"position":"topright","type":"unknown","title":"v","extra":null,"layerId":"legend401","className":"info legend kde_airbnb_2019_SG_ppp_jit_adaptive_raster","group":"kde_airbnb_2019_SG_ppp_jit_adaptive_raster"}]},{"method":"addLayersControl","args":[[],"kde_airbnb_2019_SG_ppp_jit_adaptive_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.16218335265381,1.47066364891549],"lng":[103.605646858975,104.087962389458]},"fitBounds":[1.1641988317039,103.605646858975,1.4706519681352,104.085357795856,[]]},"evals":[],"jsHooks":[]}</script>
</div>
<div style="display:inline;width:49%;float:left;border-style:solid;border-color:#BEBEBE;border-width:1px 1px 1px 1px;">
<div id="htmlwidget-5100" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-5100">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAGqklEQVR4nO2dvW4bORSFrxZGihRJjCBQs0UEI0WKAIabAHqVPIHfIg+xgB9gnyOtEDdpUqQIBKlIIwhBbBcq3Mw2S4OiyOE/eck5H5Ai8ojicM4c/l/OCBAR0e7hcTD9bf7i2axkXqYGCpfMApTFt3t4HCDGPEy6UMfczwYEmY5JFmSM+FQgxnj+qp2B0qQUIEjDpN7iXAKEG8bBtvBSdQRKOh/EGAarQrMJxvch16p6IUY/2LQJUwsGAmwHFiJ0FUzq63JR+/dbo+pbm+JhqQPKsemlAG7oR7XC4iKYHECEflSpjnsWIFH/92fD9/6LvbFTejA6J8Tcs5nshTIl8RGdCtBlcYQvIs1eRJ31JqYmQMH8xbOZy72HiEiXbutiZDFE0xulh5J2D49D7hc+Z/pnuRIGx+jccbs/0M1qMxARXS8XMyKiy89fhg/vXhMR0b+fLpM4XKrqO1e7FiIshM5JPl68enqgl5+/DOsfv06+d7u+G+TrxsZF1f+rws/RPk1BFhFOtS3ow3Z/oNv13fDP1y0REX3/+ZuIiNY/fpFwQuGSJoR4TOXdyrpJtAkr8m33R/v595+/n0RJ5LawQ/xLm8MyJHdCuKCd7f7gdN1qc0/Xy8Xsdn03pGrXcRRqUhFCgGZU4ZlcUOVmtTlqE451DuS/tTSUg45JAUwCXG3uj6pdE3LnxEdIXEWnAhEWRHa/1eZee83F+7+1n8vOZhKX/HkrAiTqSISq27x987xSTsIRAhS94+XiJV3Nz0+u620eulkR2hr3LYpSFp+MLu8hQuQaZaJJEbo28nUuUhORHzm/QngCWYC2/KdcyFDTXZsfJ3TtZdZE52Sq28mfXc3PnwSYwsFLzC3HkEz5JW9SdkK5pykjP1Ci+tVxiHv75tm0jtErEUM6OYmujjm/YZyQBbXdH0ar2tAXptVn0Xx13CJjIqvt2ETlxdxkx0THcvHyqUpWq2KOcBDbGCU7KtHry1JlxBddu1Alpn01dUq2C6P3OdTGNl4I8aUjlzCbbxNCZOXIZTxByubigjI6R4RA85DaEbsRIahDCkE2EWoN8CK1EzbfJqyJ6wppMI6zCOGCxwgBQojxwAkTsN0fJiNG7DtmwFTEVhKIsBAtLrItBarjAujcs8UqPNeMiVOi6JSc4jo47iq0FpwxlwhRHSdAFVCIw233B9ZCzLmgASIMJMb1WqLEahqrCFEV2+lRfETllnPBCSPpXYAltolChBH0KkCi8Vg2qWtH4xAN922CtWlZgNyiNzg7oWsw8JYQQortlY7tfXbd55KrZxwjOJeYNynwqo5z2bHtN1P/XoyLhYZ4K41NKLajLkq6pVaEuocu775KIQw1DV2h5CiIlNXot90fbXQtXXQFHbHul7J8moxFEyNE8V3VWVVRcos+ZRKwHGPww7vXtNrcW4UYKkBO5ZEKFnPHY8dwcW2HChdUg1y6BL0MCe/RckxqG15OqEaBChGJ/F2f6+U8cBOnOPrBFOBSkCK2TI+ciDBUVCliJLtc7yLisXt4++Z5sl6xCZf4gipTEZyOoDahrq0mu1PomW2lHkRq8ckOKOINihOabtd3LANTcuJEhLmqurEhAF3HRHddT/R6XyEEd0xMgnGJkadz0dB86Kj9gIULAjeOnDC1A9rSc6m+XappnchLdV504X6Xq80gZko+XrxiN9TEjSxDNGPzziVmXXKlrbYlXQalIUA7QdN2Y7icJGmqyl0OCtTlQffd3C54NT9vJmA7d86I0h7+XPJ7MiYR28Qfi80NW15tUwqvQNupAnP7YJtjNmE7Ay42X7ogndfLxezm//agfB4dGKcJEeZMPyb/qstBeGEUmzu2zX3Warz7Hlgo/+O8O64lvBa1hv6IevBfaOclF65jm2qzQHxvbFYE2DEubEx5bpouPRch1kBXBlzz2gva3nGOwnUZmOb2UNU8c1q50xPauePSmeAkPtuYI6e89kLVLZ9cH6jrwLl8ff5c9ctJYccUqGt11dpD43pOcC+cDNGg3QNKk3ScsFdXKLX/dqqw2OgUg+zcOaNG5F4DOWWcBo59yd14tw0k5/hNkI/mndC3Jwv4UUSEOZbvy9NmXBwPog+jm6hcY4tdS90Hl5ehNbK0CaeKvDEf5ecOgmRGgg5RPGfcQmq0CEQXh/ce4SmDajYP7AoUL8H0YPWAYztJuviGY+nA2XjAZrC6dPQHwAc2IqzlSBBrfbqqisaW46PaBQBMg9amGgEAwA6cbRqw6R2rQHygOhAhAAAAAAAAAAAApsN/lZZKi9/Jvq0AAAAASUVORK5CYII=",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.498039215686275,null,"tmap401","kde_train_station_SG_ppp_jit_adaptive_raster"]},{"method":"addLegend","args":[{"colors":["#E9F2FA","#C9DDF0","#97C6DF","#5DA5D0","#3080BD","#0D57A1"],"labels":["0.0000000 to 0.0000005","0.0000005 to 0.0000010","0.0000010 to 0.0000015","0.0000015 to 0.0000020","0.0000020 to 0.0000025","0.0000025 to 0.0000030"],"na_color":null,"na_label":"NA","opacity":0.498039215686275,"position":"topright","type":"unknown","title":"v","extra":null,"layerId":"legend401","className":"info legend kde_train_station_SG_ppp_jit_adaptive_raster","group":"kde_train_station_SG_ppp_jit_adaptive_raster"}]},{"method":"addLayersControl","args":[[],"kde_train_station_SG_ppp_jit_adaptive_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.16218335265381,1.47066364891549],"lng":[103.605646858975,104.087962389458]},"fitBounds":[1.1641988317039,103.605646858975,1.4706519681352,104.085357795856,[]]},"evals":[],"jsHooks":[]}</script>
</div>
<div style="display:inline;width:49%;float:left;border-style:solid;border-color:#BEBEBE;border-width:1px 1px 1px 1px;">
<div id="htmlwidget-8777" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-8777">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAFm0lEQVR4nO2dv0/cMBTHfRUSA0tBsFCBClRCggVmxv4HSJW69K/rglSJ/6BjZ7pQCanQqohbioCFgek6VDn5HMex4/fs5/j7mQ7uzpc4nzz/iPMyUUAppdTjy/2s673V5fVJym2pDVSu6hZQl+/x5X4GGXmoulJd0a8PCElHlRUZI58JZIznVe4NSA2lgICGqs5iLgERDeMQW3lUA4GUkQ8yDkNUpfUJE3qQczW9kDEMMX1CamEgYDmIkNBXGOrPcZH790sj61lLcbDMCeXY8ihANAwjW2VJEYYDSBhGluZ4zAIqNf796yN0/5OdsTUdGFskxLXnbtgrpSb5lGoL6LM4IpSmzLFIzboTtQnYsLq8PvHZ9yES2cotXUYRUzRjI/VU0uPL/Yz7hOcsHxImoitamQI1f1MedKryuEREc5yRvjnOpll3CdxXPlW3gLMfyiIh5KOl78DH1nfuPiUkLARfUYbU/egkhIC0mE1qbFTMLZwN0g2CgDz43nClv1fSVM5S7g0A/ehyhYgkVToTRMICKUUuXzBPWCBjO9kRCQuG8naHnNEVkbBgKK+s5AwgGJhUgPQWiiwES9/RGuhax0hRDidF3dcL0pBaQvQJQYvUgQUSAispRYwKu2iKx0vKJjn6PgdQD1xiojkG3ohaWY0oWDfUERESgigohCwi1RqQBXUkRJ8QZMdbQkRBwAUiIQiCY5oGEoLsQEKQHUgIvMl6xQSDEsAJIiHwgnNBA5b3AycpVtN4Z2MC9ZFqORciIbDiSidifiYWSAisuHLZULeOnQOTFCloQR6kpRHxjoS+WT9rZPp8O3+9ubKVcUvaxAjX9d1k6wlN4XI9vkuy/Lp8JrlljE0Rkv0eE59nb1CkqHUlf+zLtZebRsCrp6vWe/uv9+evOWWU1qwOZfDAJCZCmQnBm3JMKSU+BUmPfo2A3//+mP/vaONAXT1dLYhIibT6oEDE6Nj1GC6JUVCpRQG//fm18N7RxsH89fT5NjoajlE8nSAJzccIDJEkNONoVzMtQU6bgObfMRFx7PI1tCQcKhVFjmSfz/tIzCXo9Pm2FQGvr+/U75/T+WfevttUSi1GQx9qEc7GoObY1lfTo9PQZ7aVeCB0AXVOdz9OlFLq8uFCZGJKSbQk5GrqfKZ8Sso4r5RS19d3Xp+z9Qsl71dqBi/l6hLGJ0eeLYoO3Q4buQ/w1w+f579vm8IBiyxEQuoI2FeeT/Pt00zbJKeO6LaJ6b29N9bPvv/yaXayvaOU+t8sXz5cFNnVSAXLolbXdecUE9CpRs4n2zstEc2/z2/OZodrxxDQQdDAJORpkK7vup5o2VembRts36UWcXNlS02fbxemXJpJalO8k+2d4NFxzSwpRfvw55Tf0+mSmPOaN0SjISjRNlVi7hBCHzDYEPOc4C5s/UJ94HG6+3FyfnM2a14P+Y0aKUJCzvJDt9+1cgZ9v2Eku3bcNyDJdSku5HfNE8I1EQ38CVrUOvRH9O+6DnrONYvm/2zTPma3oIl8kDGO1uKA5jXlc9Ns5fmImANbHUjd1rFgHR1zVK7PxLSEg6pfYjO3WcLKnTFivXaceiMkyNdwuHY8uXy4mOnXemNaCNBP1kWtUg/o4dqx18R5g9T9KIVWZcdU6NBRpnSkPid4LLSuHaPfA1JDuoBhrFEh1f23tVJ8ajg9cnNmjeBeA1kzXhPHoXB33vsmkjl+E/BRfCT0XQIG5JJEQo7l+/qtBFIiHqQfxmiycrkWu6baDyknQ2mw9AlrRb8xH/Xnj4g0ICWDAVE8S1JSapQMpIsj+B7hmkEzy4O4CsVJUB+iDnDsIMmW39BVDiKbDMRMVqfO/gDkIEbCXBEJsuZnVE2Razk+ml0AQB2UdqkRAAD6QWSrAzGjYxPIB7IDCQEAAAAAAAAAAFAP/wCUc8kjcwNhNQAAAABJRU5ErkJggg==",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.498039215686275,null,"tmap401","kde_tourism_SG_ppp_jit_adaptive_raster"]},{"method":"addLegend","args":[{"colors":["#EFF9EC","#D5EECF","#AEDEA8","#7EC97E","#43AB5D","#208842","#006428"],"labels":["0.000000 to 0.000001","0.000001 to 0.000002","0.000002 to 0.000003","0.000003 to 0.000004","0.000004 to 0.000005","0.000005 to 0.000006","0.000006 to 0.000007"],"na_color":null,"na_label":"NA","opacity":0.498039215686275,"position":"topright","type":"unknown","title":"v","extra":null,"layerId":"legend401","className":"info legend kde_tourism_SG_ppp_jit_adaptive_raster","group":"kde_tourism_SG_ppp_jit_adaptive_raster"}]},{"method":"addLayersControl","args":[[],"kde_tourism_SG_ppp_jit_adaptive_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.16218335265381,1.47066364891549],"lng":[103.605646858975,104.087962389458]},"fitBounds":[1.1641988317039,103.605646858975,1.4706519681352,104.085357795856,[]]},"evals":[],"jsHooks":[]}</script>
</div>
<div style="display:inline;width:49%;float:left;border-style:solid;border-color:#BEBEBE;border-width:1px 1px 1px 1px;">
<div id="htmlwidget-1137" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1137">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAFFklEQVR4nO2dS04cMRCGPWFuwSZ7lB0bLoFy1IhLsGGHZs+GWwSRDRaOx49yu6pctv9PihSY6cZtf11+tvvkgHPOuY/3l8/cZze39yfNtOwGMtflBQzl+3h/+YSMMmydqaXoVwNC8rFlRvbIFwMZ+/kxOgHacAoIeNjqLpYSENGwD7OZx9UR0Ix8kPEYpjKtJkxrIY+qeiFjG2bahNzCQMB5MCEhVRju70kx+u/PxtC7lqOw4gHl3vNxgGjYxrDMsiKMBJCwjSHV8coCOrf+9dVovX61O3angklFQsw95xHPlJ3kc+5aQMriiFb8OVeRWvQidhPQc3N7f6Jc+xGJUuedXUYTQzSroT2U9PH+8il9w0ueHxIqkYtWsUD+Z85C5zqflIiojgdSG+P01XpJ4Nr5uZoFku1QEQkhHy+1gu/N79FtSkg4CVRRjuT9chJCQF7iKrU3Ko4WLgVrgiCgDNQHrsLPZhrKOY9OAKgTytUiklXpYhAJJ2QWuahgnHBCVrvZEQknhvNxh5HRFZFwYjhnVkYGEHRMNsB6DcUWgq1f6A7k1jFynEeSqZ7rBTpoS4g2IbhCO7BAQpBEU8SusIuqeF00q+Tu5xzAPkiJieoYkDG1shpRcG+4IyIkBF1wCDnFVmvAFtyREG1CMByyhIiCQApEQtCExDANJATDgYRgOJAQkBk6Y4JOCZAEkRCQkFzQgOX9oIjGahrybkxgP7SWcyESgiSl7UTi7/SCNiE3l6fRKWAh9Tjpze39SSI6ZiMhquEDeAEvT87dPV7/3hN+NgDq5plaZK1O3QWWEm6KQLK/z3/c+eF3/RglEY/u8lo6lpsmCXOfSWJe/khAT1VEYQl7twjRfMYkWR2nCj3enoxji9rS5o8zvXzGy/f2/Oqcc+7nw6/vD+8exapjzvwZmdeHe8c9IsYbgvvzxFLOIqKXLwtj1JshP1oxMURTeg3XLFVxCKlN2MCK4oU0SRi/RuCIJK07juaqaUty+ur37fn1uypmiH6ry+c5tIEOdeOdUZmoJuhXJEx2SBol3EW4FId3cSqJePSdbVwFoSJhRUDNGYfZuaqOpao6ypCPpWjawn9tQGIEnOG6tDg8bZcThlJVx9/hLhDRAr48JaOg2t9fkP8iIXcErJ2PUn1TquncHKd65+UrCs461DQKkSEaSjtIUhDRQvfV7eWJNBQDAes0SdjyNsjSsaU3WtbOmUpD6ljVKDh4QcLsnJ3jffmz5nEhOYnF5rz9dBwE7KZpiIZrY+4WWl8w6Ol5T/BRwrSiCqZjYtquxpECLR0juSII8rWjtrK6tip3VOG1vrAw/CeZrp0gR8KeTA+PLXVARq5ZjH9XW9QbimhpHntGrhYH+P9zvjctdT6KiCNI5YHVtK5CsncskbmUBru1Qo3TjIgnQ3LuWDsRluSrjTlaSusqDO0dWy1Q6sB5+H35VK3LVWb3ZGjPMjDLYDmWLFdDNGj3AG1YxwlXjQq561r1erWZfhuQMHJzvgk9RnoN5M6QBo5bkW68U3eHgChzMH0kbO3JAnuoSCixfD+cNrMS8SD9MbISSravJCgtdtW6Dis3w2yItAl3JXwwH/lHZ4r1hJZBh6ifs7UtNWYE0vXR/IzwzqCalcFchuIm2A9TBdzbSUo9dF46DyKbDcwMVmvv/gDsYEbC5beRA1mWqopKy/FR7QIA9mC2qUYAAKiDyLYHZnrHMZAPDAcSAgAAAAAAAAAAYB/+AbJqks/Lv3XdAAAAAElFTkSuQmCC",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.498039215686275,null,"tmap401","kde_hotels_SG_ppp_jit_adaptive_raster"]},{"method":"addLegend","args":[{"colors":["#FDE5CC","#FDBA7E","#F9812E","#D94801"],"labels":["0.00000 to 0.00001","0.00001 to 0.00002","0.00002 to 0.00003","0.00003 to 0.00004"],"na_color":null,"na_label":"NA","opacity":0.498039215686275,"position":"topright","type":"unknown","title":"v","extra":null,"layerId":"legend401","className":"info legend kde_hotels_SG_ppp_jit_adaptive_raster","group":"kde_hotels_SG_ppp_jit_adaptive_raster"}]},{"method":"addLayersControl","args":[[],"kde_hotels_SG_ppp_jit_adaptive_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.16218335265381,1.47066364891549],"lng":[103.605646858975,104.087962389458]},"fitBounds":[1.1641988317039,103.605646858975,1.4706519681352,104.085357795856,[]]},"evals":[],"jsHooks":[]}</script>
</div>
<script>
HTMLWidgets.addPostRenderHandler(function() {
var leaf_widgets = {};
                Array.prototype.map.call(
                 document.querySelectorAll(".leaflet"),
                   function(ldiv){
                     if (HTMLWidgets.find("#" + ldiv.id) && HTMLWidgets.find("#" + ldiv.id).getMap()) {
                        leaf_widgets[ldiv.id] = HTMLWidgets.find("#" + ldiv.id).getMap();
                     }
                   }
                );
               
});
</script>
</div>
<p>From the use of openstreetmap above, we are able to tell that most of the similar clusters seem to occur around places like Suntec City and Rochor.</p>
<p>The main benefits of using a KDE map would be that we can effectively classify the spatial points into neighbourhoods and thus, be able to distinguish neighbourhood that have higher number of Airbnb listing, Train station, tourism spots or Hotels in the area. Whereas point map are not able to help us visually see how many points are within an area, if multiple points overlap each other on the map.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="nd-order-spatial-point-patterns-analysis">2nd order spatial point patterns analysis</h3>
<p>Finding out the planning subzones to do further focused analysis</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='va'>airbnb_raster_map_2</span> <span class='op'>=</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>train_station_raster_map_2</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_train_station_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>tourism_raster_map_2</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_tourism_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>hotels_raster_map_2</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_hotels_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>airbnb_raster_map_2</span>,<span class='va'>train_station_raster_map_2</span>,<span class='va'>tourism_raster_map_2</span>,<span class='va'>hotels_raster_map_2</span>,ncol<span class='op'>=</span><span class='fl'>2</span>,nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-81-1.png" width="624" /></p>
</div>
<p>Plotting the raster on planning subzones to identify subzones with possible cluster of airbnb listing in 2019</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_facets</span><span class='op'>(</span>by <span class='op'>=</span> <span class='st'>"PLN_AREA_N"</span>,
          free.coords <span class='op'>=</span> <span class='cn'>TRUE</span>,
          drop.shapes <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'>tm_borders</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-82-1.png" width="624" /></p>
</div>
<p>Some subzones to zoom in on are outram, rochor, Singapore river, Kallang, geylang for airbnb listing.</p>
<p>Plotting the raster on planning subzones to identify subzones with possible cluster of train stations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_train_station_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_facets</span><span class='op'>(</span>by <span class='op'>=</span> <span class='st'>"PLN_AREA_N"</span>,
          free.coords <span class='op'>=</span> <span class='cn'>TRUE</span>,
          drop.shapes <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'>tm_borders</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-83-1.png" width="624" /></p>
</div>
<p>Some areas identified for train stations are rochor, Singapore river, downtown core, museum and Punggol.</p>
<p>Plotting the raster on planning subzones to identify subzones with possible cluster of tourism spots.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_tourism_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_facets</span><span class='op'>(</span>by <span class='op'>=</span> <span class='st'>"PLN_AREA_N"</span>,
          free.coords <span class='op'>=</span> <span class='cn'>TRUE</span>,
          drop.shapes <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'>tm_borders</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-84-1.png" width="624" /></p>
</div>
<p>Some areas identified for tourism spots are rochor, Singapore river, downtown core and museum.</p>
<p>Plotting the raster on planning subzones to identify subzones with possible cluster of hotels.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_hotels_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_facets</span><span class='op'>(</span>by <span class='op'>=</span> <span class='st'>"PLN_AREA_N"</span>,
          free.coords <span class='op'>=</span> <span class='cn'>TRUE</span>,
          drop.shapes <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'>tm_borders</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-85-1.png" width="624" /></p>
</div>
<p>Some areas identified for tourism spots are rochor, Singapore river, downtown core and museum.</p>
<p>Of all the areas identified the top 4 most commonly identified areas with possible clusters are Rochor, Singapore river, downtown core and museum, thus we will be zooming into these areas for testing our hypothesis of whether there is any 2nd order effects.</p>
<h4 id="extracting-the-focused-subzones-as-study-area">Extracting the focused subzones as study area:</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rochor</span> <span class='op'>=</span> <span class='va'>mpsz</span><span class='op'>[</span><span class='va'>mpsz</span><span class='op'>@</span><span class='va'>data</span><span class='op'>$</span><span class='va'>PLN_AREA_N</span> <span class='op'>==</span> <span class='st'>"ROCHOR"</span>,<span class='op'>]</span>
<span class='va'>sr</span> <span class='op'>=</span> <span class='va'>mpsz</span><span class='op'>[</span><span class='va'>mpsz</span><span class='op'>@</span><span class='va'>data</span><span class='op'>$</span><span class='va'>PLN_AREA_N</span> <span class='op'>==</span> <span class='st'>"SINGAPORE RIVER"</span>,<span class='op'>]</span>
<span class='va'>dc</span> <span class='op'>=</span> <span class='va'>mpsz</span><span class='op'>[</span><span class='va'>mpsz</span><span class='op'>@</span><span class='va'>data</span><span class='op'>$</span><span class='va'>PLN_AREA_N</span> <span class='op'>==</span> <span class='st'>"DOWNTOWN CORE"</span>,<span class='op'>]</span>
<span class='va'>museum</span> <span class='op'>=</span> <span class='va'>mpsz</span><span class='op'>[</span><span class='va'>mpsz</span><span class='op'>@</span><span class='va'>data</span><span class='op'>$</span><span class='va'>PLN_AREA_N</span> <span class='op'>==</span> <span class='st'>"MUSEUM"</span>,<span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rochor</span>, main <span class='op'>=</span> <span class='st'>"Rochor"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>sr</span>, main <span class='op'>=</span> <span class='st'>"Singapore River"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dc</span>, main <span class='op'>=</span> <span class='st'>"Downtown Core"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>museum</span>, main <span class='op'>=</span> <span class='st'>"Museum"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-87-1.png" width="624" /></p>
</div>
<p>Converting spatial point data frame into generic sp format:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rochor_sp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>rochor</span>, <span class='st'>"SpatialPolygons"</span><span class='op'>)</span>
<span class='va'>sr_sp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>sr</span>, <span class='st'>"SpatialPolygons"</span><span class='op'>)</span>
<span class='va'>dc_sp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>dc</span>, <span class='st'>"SpatialPolygons"</span><span class='op'>)</span>
<span class='va'>museum_sp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>museum</span>, <span class='st'>"SpatialPolygons"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Creating owin objects:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rochor_owin</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>rochor_sp</span>, <span class='st'>"owin"</span><span class='op'>)</span>
<span class='va'>sr_owin</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>sr_sp</span>, <span class='st'>"owin"</span><span class='op'>)</span>
<span class='va'>dc_owin</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>dc_sp</span>, <span class='st'>"owin"</span><span class='op'>)</span>
<span class='va'>museum_owin</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>museum_sp</span>, <span class='st'>"owin"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Combining airbnb 2019, train station, tourism and hotel points with the study area:</p>
<p>Changing each points mark to a uniquely identifiable mark where:</p>
<ul>
<li>a = Airbnb listing in 2019</li>
<li>b = Train Station</li>
<li>c = Tourism Spots</li>
<li>d = Hotels</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>marks</span><span class='op'>(</span><span class='va'>airbnb_2019_ppp_jit</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='st'>"a"</span><span class='op'>)</span>
<span class='fu'>marks</span><span class='op'>(</span><span class='va'>train_station_ppp</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='st'>"b"</span><span class='op'>)</span>
<span class='fu'>marks</span><span class='op'>(</span><span class='va'>tourism_ppp_jit</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='st'>"c"</span><span class='op'>)</span>
<span class='fu'>marks</span><span class='op'>(</span><span class='va'>hotels_ppp_jit</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='st'>"d"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Limiting all points to within study areas only, namely rochor, singapore river, downtown core and museum:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rochor_ppp_jit</span> <span class='op'>=</span> <span class='fu'>superimpose</span><span class='op'>(</span><span class='va'>airbnb_2019_ppp_jit</span><span class='op'>[</span><span class='va'>rochor_owin</span><span class='op'>]</span>, <span class='va'>train_station_ppp</span><span class='op'>[</span><span class='va'>rochor_owin</span><span class='op'>]</span>, <span class='va'>tourism_ppp_jit</span><span class='op'>[</span><span class='va'>rochor_owin</span><span class='op'>]</span>,<span class='va'>hotels_ppp_jit</span><span class='op'>[</span><span class='va'>rochor_owin</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>sr_ppp_jit</span> <span class='op'>=</span> <span class='fu'>superimpose</span><span class='op'>(</span><span class='va'>airbnb_2019_ppp_jit</span><span class='op'>[</span><span class='va'>sr_owin</span><span class='op'>]</span>, <span class='va'>train_station_ppp</span><span class='op'>[</span><span class='va'>sr_owin</span><span class='op'>]</span>, <span class='va'>tourism_ppp_jit</span><span class='op'>[</span><span class='va'>sr_owin</span><span class='op'>]</span>,<span class='va'>hotels_ppp_jit</span><span class='op'>[</span><span class='va'>sr_owin</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>dc_ppp_jit</span> <span class='op'>=</span> <span class='fu'>superimpose</span><span class='op'>(</span><span class='va'>airbnb_2019_ppp_jit</span><span class='op'>[</span><span class='va'>dc_owin</span><span class='op'>]</span>, <span class='va'>train_station_ppp</span><span class='op'>[</span><span class='va'>dc_owin</span><span class='op'>]</span>, <span class='va'>tourism_ppp_jit</span><span class='op'>[</span><span class='va'>dc_owin</span><span class='op'>]</span>,<span class='va'>hotels_ppp_jit</span><span class='op'>[</span><span class='va'>dc_owin</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>museum_ppp_jit</span> <span class='op'>=</span> <span class='fu'>superimpose</span><span class='op'>(</span><span class='va'>airbnb_2019_ppp_jit</span><span class='op'>[</span><span class='va'>museum_owin</span><span class='op'>]</span>, <span class='va'>train_station_ppp</span><span class='op'>[</span><span class='va'>museum_owin</span><span class='op'>]</span>, <span class='va'>tourism_ppp_jit</span><span class='op'>[</span><span class='va'>museum_owin</span><span class='op'>]</span>,<span class='va'>hotels_ppp_jit</span><span class='op'>[</span><span class='va'>museum_owin</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Plotting out the spatial point on 4 different maps, identifiable by their subzone name.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rochor_ppp_jit</span>, main <span class='op'>=</span> <span class='st'>"Rochor"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>sr_ppp_jit</span>, main <span class='op'>=</span> <span class='st'>"Singapore River"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dc_ppp_jit</span>, main <span class='op'>=</span> <span class='st'>"Downtown Core"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>museum_ppp_jit</span>, main <span class='op'>=</span> <span class='st'>"Museum"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-92-1.png" width="624" /></p>
</div>
<p>KDE of each subzone, split by the different point types:</p>
<p>Rochor:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>rochor_ppp_jit</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-93-1.png" width="624" /></p>
</div>
<p>Singapore River:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>sr_ppp_jit</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-94-1.png" width="624" /></p>
</div>
<p>Downtown Core:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>dc_ppp_jit</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-95-1.png" width="624" /></p>
</div>
<p>Museum:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>museum_ppp_jit</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-96-1.png" width="624" /></p>
</div>
<h4 id="constructing-the-hypothesis-statement">Constructing the hypothesis statement</h4>
<p>Perfroming CSR testing on the Cross L-Function</p>
<ol type="1">
<li>Airbnb Listings 2019 and Train Station</li>
</ol>
<p>The hypothesis and test are as follows:</p>
<p>Ho = The distribution of Airbnb Listings 2019 and Train Station are spatially independent.</p>
<p>H1= The distribution of Airbnb Listings 2019 and Train Station are NOT at spatially independent.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001 (i.e.at 99.9% confident interval).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rochor_Lcross_airbnb2019_trainStation</span> <span class='op'>&lt;-</span> <span class='fu'>Lcross</span><span class='op'>(</span><span class='va'>rochor_ppp_jit</span>, i<span class='op'>=</span><span class='st'>"a"</span>, j<span class='op'>=</span><span class='st'>"b"</span>, correction<span class='op'>=</span><span class='st'>'border'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rochor_Lcross_airbnb2019_trainStation</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, 
     xlab <span class='op'>=</span> <span class='st'>"distance(m)"</span>, 
     xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-97-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>rochor_Lcross_airbnb2019_trainStation.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>rochor_ppp_jit</span>, <span class='va'>Lcross</span>, i<span class='op'>=</span><span class='st'>"a"</span>, j<span class='op'>=</span><span class='st'>"b"</span>, correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>999</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60
........Error in Kcross(X, i, j, ..., correction = correction) : 
  No points have mark j = b
[retrying]
.70.........80.........90.........100.........110.......Error in Kcross(X, i, j, ..., correction = correction) : 
  No points have mark j = b
[retrying]
..120
.........130.........140......Error in Kcross(X, i, j, ..., correction = correction) : 
  No points have mark j = b
[retrying]
...150.........160.........170.........180
.........190.........200.........210.........220.........230.........240
.........250.........260.........270.........280.........290.........300
.........310.........320.........330.........340.........350.........360
.........370.........380.........390.........400.........410.........420
.........430.........440.........450.........460Error in Kcross(X, i, j, ..., correction = correction) : 
  No points have mark j = b
[retrying]
.........470.........480
.........490.........500.........510.........520.........530.........540
.........550.........560.........570.........580.........590.........600
.........610.........620.........630.........640.........650.........660
.........670.........680.........690.........700.........710.........720
.........730.........740.........750.........760.........770.........780
.........790.........800.........810.........820.........830.........840
.........850.........860.........870.........880.........890.........900
.........910.........920.........930.........940.........950.........960
.........970.........980.........990........ 999.

Done.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rochor_Lcross_airbnb2019_trainStation.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-99-1.png" width="624" /></p>
</div>
<p>Based on the plot above for cross L-function, we know that the distribution of Airbnb listing in 2019 and train stations are spatially independent, however, we cannot reject the null hypothesis since the empirical l-cross line is within the envelop of the 99.9% confidence interval.</p>
<ol start="2" type="1">
<li>Airbnb Listings 2019 and Tourism</li>
</ol>
<p>The hypothesis and test are as follows:</p>
<p>Ho = The distribution of Airbnb Listings 2019 and Tourism are spatially independent.</p>
<p>H1= The distribution of Airbnb Listings 2019 and Tourism are NOT at spatially independent.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001 (i.e.at 99.9% confident interval).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rochor_Lcross_airbnb2019_tourism</span> <span class='op'>&lt;-</span> <span class='fu'>Lcross</span><span class='op'>(</span><span class='va'>rochor_ppp_jit</span>, i<span class='op'>=</span><span class='st'>"a"</span>, j<span class='op'>=</span><span class='st'>"c"</span>, correction<span class='op'>=</span><span class='st'>'border'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rochor_Lcross_airbnb2019_tourism</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, 
     xlab <span class='op'>=</span> <span class='st'>"distance(m)"</span>, 
     xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-100-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>rochor_Lcross_airbnb2019_tourism.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>rochor_ppp_jit</span>, <span class='va'>Lcross</span>, i<span class='op'>=</span><span class='st'>"a"</span>, j<span class='op'>=</span><span class='st'>"c"</span>, correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>999</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60
.........70.........80.........90.........100.........110.........120
.........130.........140.........150.........160.........170.........180
.........190.........200.........210.........220.........230.........240
.........250.........260.........270.........280.........290.........300
.........310.........320.........330.........340.........350.........360
.........370.........380.........390.........400.........410.........420
.........430.........440.........450.........460.........470.........480
.........490.........500.........510.........520.........530.........540
.........550.........560.........570.........580.........590.........600
.........610.........620.........630.........640.........650.........660
.........670.........680.........690.........700.........710.........720
.........730.........740.........750.........760.........770.........780
.........790.........800.........810.........820.........830.........840
.........850.........860.........870.........880.........890.........900
.........910.........920.........930.........940.........950.........960
.........970.........980.........990........ 999.

Done.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rochor_Lcross_airbnb2019_tourism.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-102-1.png" width="624" /></p>
</div>
<p>Based on the plot above for cross L-function, we know that the distribution of Airbnb listing in 2019 and tourism spots are NOT spatially independent, however, we cannot reject the null hypothesis since the empirical l-cross line is within the envelop of the 99.9% confidence interval.</p>
<ol start="3" type="1">
<li>Airbnb Listings 2019 and Hotels</li>
</ol>
<p>The hypothesis and test are as follows:</p>
<p>Ho = The distribution of Airbnb Listings 2019 and Hotels are spatially independent.</p>
<p>H1= The distribution of Airbnb Listings 2019 and Hotels are NOT at spatially independent.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001 (i.e.at 99.9% confident interval).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rochor_Lcross_airbnb2019_hotel</span> <span class='op'>&lt;-</span> <span class='fu'>Lcross</span><span class='op'>(</span><span class='va'>rochor_ppp_jit</span>, i<span class='op'>=</span><span class='st'>"a"</span>, j<span class='op'>=</span><span class='st'>"d"</span>, correction<span class='op'>=</span><span class='st'>'border'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rochor_Lcross_airbnb2019_hotel</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, 
     xlab <span class='op'>=</span> <span class='st'>"distance(m)"</span>, 
     xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-103-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>rochor_Lcross_airbnb2019_hotel.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>rochor_ppp_jit</span>, <span class='va'>Lcross</span>, i<span class='op'>=</span><span class='st'>"a"</span>, j<span class='op'>=</span><span class='st'>"d"</span>, correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>999</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60
.........70.........80.........90.........100.........110.........120
.........130.........140.........150.........160.........170.........180
.........190.........200.........210.........220.........230.........240
.........250.........260.........270.........280.........290.........300
.........310.........320.........330.........340.........350.........360
.........370.........380.........390.........400.........410.........420
.........430.........440.........450.........460.........470.........480
.........490.........500.........510.........520.........530.........540
.........550.........560.........570.........580.........590.........600
.........610.........620.........630.........640.........650.........660
.........670.........680.........690.........700.........710.........720
.........730.........740.........750.........760.........770.........780
.........790.........800.........810.........820.........830.........840
.........850.........860.........870.........880.........890.........900
.........910.........920.........930.........940.........950.........960
.........970.........980.........990........ 999.

Done.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rochor_Lcross_airbnb2019_hotel.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-105-1.png" width="624" /></p>
</div>
<p>Based on the plot above for cross L-function, we know that the distribution of Airbnb listing in 2019 and Hotels are NOT spatially independent, however, we cannot reject the null hypothesis since the empirical l-cross line is within the envelop of the 99.9% confidence interval.</p>
<h4 id="conclusion-for-2nd-order-effect">Conclusion for 2nd order effect</h4>
<p>It seems that airbnb listings have spatial dependency with tourism spots and hotels while having spatial independence from train stations, we can conclude that the airbnb listings tend to appear more and closer to tourism spots and hotels, thus a possible strategic location for new airbnb listers.</p>
<h2 id="section-b-impact-of-covid-19">Section B: Impact of COVID 19</h2>
<h3 id="exploratory-spatial-data-analysis-1">Exploratory Spatial Data Analysis:</h3>
<p>First let us plot the spatial points of airbnb listings in 2019 and 2021 onto the map (mpsz) to look at the spread of Airbnb Listings in the 2 years.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_map</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>airbnb_2019_sf</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span>,
          col <span class='op'>=</span> <span class='st'>"#CC0033"</span><span class='op'>)</span>
<span class='va'>airbnb_2021_map</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>airbnb_2021_sf</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span>,
          size <span class='op'>=</span> <span class='fl'>0.05</span>,
          col <span class='op'>=</span> <span class='st'>"#0066CC"</span><span class='op'>)</span>
<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>airbnb_2019_map</span>, <span class='va'>airbnb_2021_map</span>,ncol <span class='op'>=</span> <span class='fl'>2</span>, nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-106-1.png" width="624" /></p>
</div>
<h4 id="geospatial-data-wrangling-for-airbnb-2021-to-plot-kde-of-airbnb-listings-for-june-2019-and-june-2021">Geospatial data wrangling for airbnb 2021 to plot kde of airbnb listings for June 2019 and June 2021</h4>
<ol type="1">
<li>Converting sf data frames to sps Spatial* class for airbnb_2021</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021</span> <span class='op'>=</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>airbnb_2021_sf</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>To confirm if the conversion to Spatial* class was successfull</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021</span>
</code></pre>
</div>
<pre><code>class       : SpatialPointsDataFrame 
features    : 4238 
extent      : 7406.989, 43337.89, 25330, 48391.55  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 14
names       :       id,                                              name,   host_id,        host_name, neighbourhood_group, neighbourhood,       room_type, price, minimum_nights, number_of_reviews, last_review, reviews_per_month, calculated_host_listings_count, availability_365 
min values  :    49091, ! BEST ! LOCATION private room at Central Orchard,     23666, &lt;U+4F73&gt;&lt;U+4F73&gt;,      Central Region,    Ang Mo Kio, Entire home/apt,     0,              1,                 0,       15456,              0.01,                              1,                0 
max values  : 50718590,                Zimmer nah der MRT (Downtown Line), 404826677,             Zuzu,         West Region,        Yishun,     Shared room, 10286,           1000,               370,       18806,             19.74,                            165,              365 </code></pre>
</div>
<ol start="2" type="1">
<li>Converting Spatial* class into generic sp format</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_sp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>airbnb_2021</span>,<span class='st'>"SpatialPoints"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_sp</span>
</code></pre>
</div>
<pre><code>class       : SpatialPoints 
features    : 4238 
extent      : 7406.989, 43337.89, 25330, 48391.55  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </code></pre>
</div>
<ol start="3" type="1">
<li>Converting sp format into spatstats ppp format</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_ppp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>airbnb_2021_sp</span>,<span class='st'>"ppp"</span><span class='op'>)</span>
<span class='va'>airbnb_2021_ppp</span>
</code></pre>
</div>
<pre><code>Planar point pattern: 4238 points
window: rectangle = [7406.99, 43337.89] x [25330, 48391.55] units</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-112-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>airbnb_2021_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Planar point pattern:  4238 points
Average intensity 5.114513e-06 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [7406.99, 43337.89] x [25330, 48391.55] units
                    (35930 x 23060 units)
Window area = 828622000 square units</code></pre>
</div>
<p>based on the above output, we can tell that there is duplicated points and thus should identify and handle them as necessary.</p>
<p>To confirm:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>airbnb_2021_ppp</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] TRUE</code></pre>
</div>
<p>To check the number of locations with duplicated points.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>multiplicity</span><span class='op'>(</span><span class='va'>airbnb_2021_ppp</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 224</code></pre>
</div>
<p>We will use the jittering solution to handle the duplicates, since any drop of data could potentially mean loss of useful information.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_ppp_jit</span> <span class='op'>=</span><span class='fu'>rjitter</span><span class='op'>(</span><span class='va'>airbnb_2021_ppp</span>,
                             retry <span class='op'>=</span> <span class='cn'>TRUE</span>,
                             nsim <span class='op'>=</span> <span class='fl'>1</span>,
                             drop <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>airbnb_2021_ppp_jit</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
</div>
<p>We have successfully ensure that all locations do not have duplicated points for the airbnb 2021 ppp object.</p>
<p>Combining the point events objects (Airbnb_2021) with the owin object:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_SG_ppp_jit</span>  <span class='op'>=</span> <span class='va'>airbnb_2021_ppp_jit</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_SG_ppp_jit</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-119-1.png" width="624" /></p>
</div>
<h3 id="kde-1">KDE</h3>
<p>For the KDEs, the following settings are used: + adaptive bandwidth: since the airbnb distribution of listings in 2021 also showed signs of clustering in the previous point plots.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_airbnb_2021_SG_ppp_jit_adaptive</span> <span class='op'>=</span> <span class='fu'>adaptive.density</span><span class='op'>(</span><span class='va'>airbnb_2021_SG_ppp_jit</span>, method<span class='op'>=</span><span class='st'>"kernel"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>kde_airbnb_2021_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-120-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-121-1.png" width="624" /></p>
</div>
<p>From the kde plot for Airbnb listing 2021 above, we can see that the density range from 0 to 0.00085. Whereas from the kde plot for Airbnb listing 2019 above, we can see that the density range from 0 to 0.00175.</p>
<p>Converting KDE output of airbnb 2021 into grid object:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gridded_kde_airbnb_2021_SG_ppp_jit_adaptive</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.im</span><span class='op'>(</span><span class='va'>kde_airbnb_2021_SG_ppp_jit_adaptive</span><span class='op'>)</span>
<span class='fu'>spplot</span><span class='op'>(</span><span class='va'>gridded_kde_airbnb_2021_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-122-1.png" width="624" /></p>
</div>
<p>Converting grid output of airbnb 2021 into raster:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_airbnb_2021_SG_ppp_jit_adaptive_raster</span> <span class='op'>=</span> <span class='fu'>raster</span><span class='op'>(</span><span class='va'>gridded_kde_airbnb_2021_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_airbnb_2021_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : 1.675306e-19, 0.0009478933  (min, max)</code></pre>
</div>
<p>Setting back the crs/projection system information for Airbnb 2021:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>projection</span><span class='op'>(</span><span class='va'>kde_airbnb_2021_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+init=EPSG:3414"</span><span class='op'>)</span>
<span class='va'>kde_airbnb_2021_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs 
source     : memory
names      : v 
values     : 1.675306e-19, 0.0009478933  (min, max)</code></pre>
</div>
<p>Displaying the rasters of Airbnb 2019 and 2021 on a map using tmap package</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='va'>airbnb_2019_raster_map</span> <span class='op'>=</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>airbnb_2021_raster_map</span> <span class='op'>=</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2021_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>airbnb_2019_raster_map</span>,<span class='va'>airbnb_2021_raster_map</span>,ncol<span class='op'>=</span><span class='fl'>2</span>,nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-126-1.png" width="624" /></p>
</div>
<p>Using openstreetmap as the basemap</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"view"</span><span class='op'>)</span>
<span class='va'>airbnb_2019_raster_map_osm</span> <span class='op'>=</span> 
<span class='fu'>tm_basemap</span><span class='op'>(</span><span class='st'>"OpenStreetMap"</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span>, palette <span class='op'>=</span> <span class='st'>"Reds"</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>, <span class='st'>"bottom"</span><span class='op'>)</span>, frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>airbnb_2021_raster_map_osm</span> <span class='op'>=</span> 
  <span class='fu'>tm_basemap</span><span class='op'>(</span><span class='st'>"OpenStreetMap"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2021_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span>, palette <span class='op'>=</span> <span class='st'>"Blues"</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>airbnb_2019_raster_map_osm</span>,<span class='va'>airbnb_2021_raster_map_osm</span>,ncol<span class='op'>=</span><span class='fl'>2</span>,nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<div style="display:inline;width:49%;float:left;border-style:solid;border-color:#BEBEBE;border-width:1px 1px 1px 1px;">
<div id="htmlwidget-2173" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-2173">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAE10lEQVR4nO2dy20kNxCGOSthA1EEOvvgDNaxOIA9bgCORSEoAEMRKJAFhPGpjQaHzWcVWSS/7yRh+sEm/67io7p4c+Ccc+7r8+N+9dvTy+utZ1l2g8p11wI8i+/r8+OOGHXYulJj1i8FgpRjy4psEZ8PYmzn2+gC9EZSgCDDVm+xlgCxhm2YrTypgUBPy4cY6zBVaSnBlDbyKNeLGMsw0yeUFgwCnAcTIswVjPRxWoy+/2wMfWslGsufUG69ngRYwzKGVZYVwWiACMsY4o5XFqBz6z9fitLn7/bG7tQwIUvI2vM16pWyk/icexRgTnBEKcc1VxG16kPsJsCDp5fXW86z14godN3ZxWhiimY1ek8lfX1+3LVfeM3rI8JOXFkrX0DH/5KNLnU9LSHijgeSmuM83HpMwKnrS3ULNPuhKiJEfLKkGr61vkf3KRHhJOQKpabulxMhApTFd6mtVnG04EKIFggB6pD7wdX5t5mmcp5HFwDSnMVVIiSrovPBEk7ILOLKhXnCCVntZccSTozk5w4jrSuWcGIkV1ZGGhAGJhtg3UOJmWDrD7oDV3GMEtfRZKrveqEPvUVInxAe6G1YECEE6SnEJrOLK16Xni65+TsH2ActYeKOIRtTkdVYwb2RtoiIEJqQEOQUqdbAFtKWkD4hDCdbhFhB0AJLCEVoTNMgQhgOIoThIELIZuiKCYMS0ARLCFloBjQQ3g9RekTTZGdjgv3oFc6FJRTg/v7mnHPu9udfg0siRyydiH9MK1hCyMYXppQILwcmPVLQrsb9/e1/q2gZa2lEst1xbtZPSNPTfbcI7urcoVE0Ty+vt95vkbW3NsYhqpA1/PePH8FjtUi11fH71XHDvzHJ2XtDIkVtLPljKtcezPWCxqgeHbe4Zz8h+HEdX5TsgvTIivVhYoomtg2XdSt4dr1aLnZF4Z2p3pog99jYuan7zixOCVYX30FVAp3cxDujKrGHQO/vb6KWbxfBhajO4hQTYu2ebVINYcFK9lxxmJ2HPqGWq4u52tDAJHTcSqz6XDVUh3JdCSbHVfvHSDdIzwYOzQkisDKy9ua9onZjl9AaZIvbuhK5tEX3+4G/f/7tvv/6J3oOU01pVIJaY+vOPSag1XKmeAORlACPsiDAOEWWsGQ3yNi5LZardsfLkSDCOM/OyW7+3PO8M1cuXXKp0Ud6mmZXiqZopBJzl1C6weBByz7BtZzLivXLx8SyXYqaBk1FkBx/SwsS8ZXT7Wu7nNCiXmWpvW8q/AnqKApqrb3J+dzYdIymhYqRO7fpdwsINZPhcnQsuW9a6Ho5QhxBqA6slnUVgqNjjcrN6bBba1S/zFg8HYJrx70LYUl8oe5Ci4eANENHx1YbNNZv3SnIohcPld1SoS1hYJYhHEuXhyka+j3QG9F5wlWtQq/vb3dl+tRwZ8utmTVCOwZyZ7ImjkvR7rynJpI17gl6TG8JS0eyYI8uItQI3z8vm1mxeIi+jmWycl3lU+n5HFZehtlQ6RPuyvnDfOovnyniCS3DgKid511SamiC6Noo/kZ4Z3CzOpirUF6C/TDVwK2DpFB+w9h1sGw2MDNZLd0vpZ87D2ZEuHIaOYizlCuKhePjdgFgD2ZbagQASINl2wMzo2MfxAfDQYQAAAAAAAAAsA//ATTeaBPsCbZxAAAAAElFTkSuQmCC",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.498039215686275,null,"tmap401","kde_airbnb_2019_SG_ppp_jit_adaptive_raster"]},{"method":"addLegend","args":[{"colors":["#FDDED0","#FCA082","#F75A40","#CB181D"],"labels":["0.0000 to 0.0005","0.0005 to 0.0010","0.0010 to 0.0015","0.0015 to 0.0020"],"na_color":null,"na_label":"NA","opacity":0.498039215686275,"position":"topright","type":"unknown","title":"v","extra":null,"layerId":"legend401","className":"info legend kde_airbnb_2019_SG_ppp_jit_adaptive_raster","group":"kde_airbnb_2019_SG_ppp_jit_adaptive_raster"}]},{"method":"addLayersControl","args":[[],"kde_airbnb_2019_SG_ppp_jit_adaptive_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.16218335265381,1.47066364891549],"lng":[103.605646858975,104.087962389458]},"fitBounds":[1.1641988317039,103.605646858975,1.4706519681352,104.085357795856,[]]},"evals":[],"jsHooks":[]}</script>
</div>
<div style="display:inline;width:49%;float:left;border-style:solid;border-color:#BEBEBE;border-width:1px 1px 1px 1px;">
<div id="htmlwidget-1428" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1428">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAE1ElEQVR4nO2dP3IdIQzGceYVLlK5SOcuN8gJfCdP7uQ6F8hB3GTcuXiVC3dOtTM7PP4IkIQE36/zeJfHwreSECzcBRBCCOHt+vmV+9/jw/2dZl12A40b8gI8i+/t+vkFMcqwdaOWrF8NCJKPLRtyRHwxEOM432ZXQBtOAQIetnqLpQQIaziG2cbjGghoWj6IsQ9TjVYTTGsnz3K9EGMbZmJCbsFAgH4wIUKqYLivk2L273tj6lvL0VlxQnm0PA5gDduY1lhWBCMBRNjGFHe8sgBDWP/5arQ+v9obu1PHpCwh5p7ziDfKTuIL4VaAlMURrRxlriJq0YfYTYAHjw/3d5Rn7xFRqlzvYjSRolkN7VTS2/XzS/qFlywfIlQiZ61iAR1/c3Y6V3lSQoQ7nkgtx3m49ZKAa+VzhQWScaiICCE+XmodP9res2NKiNAJVKH0tP1yIoQAeYld6qhVnC24FKwVggBloH5wdf6fp1TOZXYFQJ2zuFqEZFV0MbCEDvEiLirIEzpktZcdltAxnJ87zLSusISO4ZxZmWlAMDDZAOseis0EW3/QHcitY+QoRxJX3/UCHbRFiJgQ3KBtWCBCkERTiENmF654XTRd8vB3DmAfpIQJdwzImFpZDSu4N9wWESIEQ3AI0sVWa8AW3JYQMSGYDlmEsIJAClhC0IREmgYiBNOBCMF0IEJAZuqMCQYlQBJYQkBCckEDlveDIhqraci7MYH90FrOBUvIwOv7RwghhJ8/vk+uCR+l7UTia0aBJQRkYmFyiTA7MNHYgnZXDss5C2vbiJDdMXXXz90pueYZ4hsRXO5ebhE3xYSUOIEbb+L/++8aQijHhxqxY00otaMupn9jQjl7g2OL2tLmj7W99izz+v5hQmhe6B4dj1ioeEPwo5xYlF5PQZIUoMf2qGEiRVM6hsuDFZRO0awovDPdRxNQry3dW/td7+IcZXXxHXRtoEPdeGdWI2oIlDvu20VwKbp3cSoJsffMNq6OsGAlNWccvHMTE0q5upKrTQ1MUtetxKrP1UP3Uq6cYCiuOr6Gu0O0OjiXfIbA2iCdzZuj92CX1BzkiNvKiVzaLf/6/Se8PD8VY0PPqSYtRBa1luadNQSiFRO+PD9Vr4EA6zRZwpbTIEv3jliu3hMvZwIRlrmEwHv4s+Z9Z3IunXOqMUZrem51mlI0XBtzt9B6wODByDnBvZzrCutHx8S0XY2eDi3dI2kdIb521L62y6Vvzv/Xqkvv7x7PUHsW0EbTotbeHznfW0rHSFqoEtTcZhwWeF1qZo3s6Jjz3LRUeRQhziDVBlbrugrJ0bFE41ICdmudGtcZFk+G5NyxdiUsiS8VLox4CFBn6ujYaoeW4tadFllocdPYIw06sgzMMliOJctNigZxD9CGNU+4qlXQ+v52V9xvDXe23JK7RkivgdwZUuK4FengvZZIlvhNIId7S9g6kgX2UBGhxPL987SZFYsH0fexzK5cKSEeVlLrOay8DN4QiQl35fxhPtqPjov1hJbBgGicyy5bakgC0Y3R/I3wzsDNymCuQfES7IepDh4dJKX2NyyVA8tmAzPJau64FHGuH8yIcOVt5ECZpVxRaTk+3C4AYA+8TTUCAEAdWLY9MDM6joH4wHQgQgAAAAAAAAAAAOzDf/pHcUJiPJ/jAAAAAElFTkSuQmCC",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.498039215686275,null,"tmap401","kde_airbnb_2021_SG_ppp_jit_adaptive_raster"]},{"method":"addLegend","args":[{"colors":["#E3EEF8","#BFD8EC","#7FB9DA","#4090C5","#1664AB"],"labels":["0.0000 to 0.0002","0.0002 to 0.0004","0.0004 to 0.0006","0.0006 to 0.0008","0.0008 to 0.0010"],"na_color":null,"na_label":"NA","opacity":0.498039215686275,"position":"topright","type":"unknown","title":"v","extra":null,"layerId":"legend401","className":"info legend kde_airbnb_2021_SG_ppp_jit_adaptive_raster","group":"kde_airbnb_2021_SG_ppp_jit_adaptive_raster"}]},{"method":"addLayersControl","args":[[],"kde_airbnb_2021_SG_ppp_jit_adaptive_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.16218335265381,1.47066364891549],"lng":[103.605646858975,104.087962389458]},"fitBounds":[1.1641988317039,103.605646858975,1.4706519681352,104.085357795856,[]]},"evals":[],"jsHooks":[]}</script>
</div>
<script>
HTMLWidgets.addPostRenderHandler(function() {
var leaf_widgets = {};
                Array.prototype.map.call(
                 document.querySelectorAll(".leaflet"),
                   function(ldiv){
                     if (HTMLWidgets.find("#" + ldiv.id) && HTMLWidgets.find("#" + ldiv.id).getMap()) {
                        leaf_widgets[ldiv.id] = HTMLWidgets.find("#" + ldiv.id).getMap();
                     }
                   }
                );
               
});
</script>
</div>
<p>From the use of openstreetmap above, we are able to tell that most of the similar clusters seem to occur around places like Kallang, tanjong pagar and Peoples Park</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="kde-of-airbnb-listings-by-room-type-as-at-june-2019-and-june-2021">KDE of airbnb listings by room type as at June 2019 and June 2021</h3>
<p>Converting room_type into a factor data type as required by spatstat package for both airbnb 2019 and 2021.</p>
<p>Re-instantiating Spatial* classes</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019</span> <span class='op'>=</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>airbnb_2019_sf</span><span class='op'>)</span>
<span class='va'>airbnb_2021</span> <span class='op'>=</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>airbnb_2021_sf</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>airbnb_2019</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Formal class &#39;SpatialPointsDataFrame&#39; [package &quot;sp&quot;] with 5 slots
  ..@ data       :&#39;data.frame&#39;: 8293 obs. of  14 variables:
  .. ..$ id                            : num [1:8293] 49091 50646 56334 71609 71896 ...
  .. ..$ name                          : chr [1:8293] &quot;COZICOMFORT LONG TERM STAY ROOM 2&quot; &quot;Pleasant Room along Bukit Timah&quot; &quot;COZICOMFORT&quot; &quot;Ensuite Room (Room 1 &amp; 2) near EXPO&quot; ...
  .. ..$ host_id                       : num [1:8293] 266763 227796 266763 367042 367042 ...
  .. ..$ host_name                     : chr [1:8293] &quot;Francesca&quot; &quot;Sujatha&quot; &quot;Francesca&quot; &quot;Belinda&quot; ...
  .. ..$ neighbourhood_group           : chr [1:8293] &quot;North Region&quot; &quot;Central Region&quot; &quot;North Region&quot; &quot;East Region&quot; ...
  .. ..$ neighbourhood                 : chr [1:8293] &quot;Woodlands&quot; &quot;Bukit Timah&quot; &quot;Woodlands&quot; &quot;Tampines&quot; ...
  .. ..$ room_type                     : chr [1:8293] &quot;Private room&quot; &quot;Private room&quot; &quot;Private room&quot; &quot;Private room&quot; ...
  .. ..$ price                         : num [1:8293] 81 80 68 200 92 102 203 120 51 58 ...
  .. ..$ minimum_nights                : num [1:8293] 180 90 6 1 1 1 1 7 30 30 ...
  .. ..$ number_of_reviews             : num [1:8293] 1 18 20 12 20 35 23 15 174 198 ...
  .. ..$ last_review                   : Date[1:8293], format: &quot;2013-10-21&quot; ...
  .. ..$ reviews_per_month             : num [1:8293] 0.01 0.28 0.21 0.13 0.21 0.35 0.23 0.16 1.92 2.13 ...
  .. ..$ calculated_host_listings_count: num [1:8293] 2 1 2 9 9 9 9 1 4 4 ...
  .. ..$ availability_365              : num [1:8293] 365 365 365 353 353 348 155 365 229 206 ...
  ..@ coords.nrs : num(0) 
  ..@ coords     : num [1:8293, 1:2] 23825 22646 23922 41778 42057 ...
  .. ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:2] &quot;coords.x1&quot; &quot;coords.x2&quot;
  ..@ bbox       : num [1:2, 1:2] 7216 25166 44098 49226
  .. ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. .. ..$ : chr [1:2] &quot;coords.x1&quot; &quot;coords.x2&quot;
  .. .. ..$ : chr [1:2] &quot;min&quot; &quot;max&quot;
  ..@ proj4string:Formal class &#39;CRS&#39; [package &quot;sp&quot;] with 1 slot
  .. .. ..@ projargs: chr &quot;+proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +to&quot;| __truncated__
  .. .. ..$ comment: chr &quot;PROJCRS[\&quot;SVY21 / Singapore TM\&quot;,\n    BASEGEOGCRS[\&quot;SVY21\&quot;,\n        DATUM[\&quot;SVY21\&quot;,\n            ELLIPSOID[&quot;| __truncated__</code></pre>
</div>
<p>Subsetting spatial data to contain only room type as column:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_rmType</span> <span class='op'>=</span> <span class='va'>airbnb_2019</span><span class='op'>[</span>,<span class='st'>"room_type"</span><span class='op'>]</span>
<span class='va'>airbnb_2021_rmType</span> <span class='op'>=</span> <span class='va'>airbnb_2019</span><span class='op'>[</span>,<span class='st'>"room_type"</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<p>To confirm successful extraction:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Formal class &#39;SpatialPointsDataFrame&#39; [package &quot;sp&quot;] with 5 slots
  ..@ data       :&#39;data.frame&#39;: 8293 obs. of  1 variable:
  .. ..$ room_type: chr [1:8293] &quot;Private room&quot; &quot;Private room&quot; &quot;Private room&quot; &quot;Private room&quot; ...
  ..@ coords.nrs : num(0) 
  ..@ coords     : num [1:8293, 1:2] 23825 22646 23922 41778 42057 ...
  .. ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:2] &quot;coords.x1&quot; &quot;coords.x2&quot;
  ..@ bbox       : num [1:2, 1:2] 7216 25166 44098 49226
  .. ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. .. ..$ : chr [1:2] &quot;coords.x1&quot; &quot;coords.x2&quot;
  .. .. ..$ : chr [1:2] &quot;min&quot; &quot;max&quot;
  ..@ proj4string:Formal class &#39;CRS&#39; [package &quot;sp&quot;] with 1 slot
  .. .. ..@ projargs: chr &quot;+proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +to&quot;| __truncated__
  .. .. ..$ comment: chr &quot;PROJCRS[\&quot;SVY21 / Singapore TM\&quot;,\n    BASEGEOGCRS[\&quot;SVY21\&quot;,\n        DATUM[\&quot;SVY21\&quot;,\n            ELLIPSOID[&quot;| __truncated__</code></pre>
</div>
<p>Converting room_type to factor data type using as.factor():</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_rmType</span><span class='op'>@</span><span class='va'>data</span><span class='op'>$</span><span class='va'>room_type</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType</span><span class='op'>@</span><span class='va'>data</span><span class='op'>$</span><span class='va'>room_type</span><span class='op'>)</span>
<span class='va'>airbnb_2021_rmType</span><span class='op'>@</span><span class='va'>data</span><span class='op'>$</span><span class='va'>room_type</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType</span><span class='op'>@</span><span class='va'>data</span><span class='op'>$</span><span class='va'>room_type</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Check if factor data type conversion was successful</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType</span><span class='op'>@</span><span class='va'>data</span><span class='op'>$</span><span class='va'>room_type</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> Factor w/ 3 levels &quot;Entire home/apt&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
</div>
<h4 id="mapping-the-geospatial-layer">Mapping the Geospatial Layer</h4>
<p>Assigning plotted map to variable:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_map_rmType</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tmap_options</span><span class='op'>(</span>check.and.fix <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>'room_type'</span>, size <span class='op'>=</span> <span class='fl'>0.02</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_facets</span><span class='op'>(</span>by<span class='op'>=</span><span class='st'>"room_type"</span><span class='op'>)</span>
<span class='va'>airbnb_2021_map_rmType</span> <span class='op'>=</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tmap_options</span><span class='op'>(</span>check.and.fix <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>'room_type'</span>, size <span class='op'>=</span> <span class='fl'>0.02</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_facets</span><span class='op'>(</span>by<span class='op'>=</span><span class='st'>"room_type"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Airbnb 2019 map by room type:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_map_rmType</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-136-1.png" width="624" /></p>
</div>
<p>Airbnb 2021 map by room type:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_map_rmType</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-137-1.png" width="624" /></p>
</div>
<h4 id="spatial-data-wrangling">Spatial Data Wrangling:</h4>
<p>Converting the SpatialPointsDataFrame into ppp format:</p>
<p>Airbnb 2019:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_rmType_ppp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType</span>,<span class='st'>"ppp"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-138-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Marked planar point pattern:  8293 points
Average intensity 9.345289e-06 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Multitype:
                frequency proportion    intensity
Entire home/apt      4264 0.51416860 4.805054e-06
Private room         3582 0.43193050 4.036516e-06
Shared room           447 0.05390088 5.037193e-07

Window: rectangle = [7215.57, 44098.31] x [25166.35, 49226.35] units
                    (36880 x 24060 units)
Window area = 887399000 square units</code></pre>
</div>
<p>Handling Duplicated Values</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_rmType_ppp_jit</span> <span class='op'>=</span> <span class='fu'>rjitter</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_ppp</span>,retry <span class='op'>=</span> <span class='cn'>TRUE</span>,
                                     nsim <span class='op'>=</span> <span class='fl'>1</span>,
                                     drop <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_ppp_jit</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
</div>
<p>Airbnb 2021:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_rmType_ppp</span> <span class='op'>=</span> <span class='fu'>as.ppp</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-142-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Marked planar point pattern:  8293 points
Average intensity 9.345289e-06 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Multitype:
                frequency proportion    intensity
Entire home/apt      4264 0.51416860 4.805054e-06
Private room         3582 0.43193050 4.036516e-06
Shared room           447 0.05390088 5.037193e-07

Window: rectangle = [7215.57, 44098.31] x [25166.35, 49226.35] units
                    (36880 x 24060 units)
Window area = 887399000 square units</code></pre>
</div>
<p>Handling Duplicated Values</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_rmType_ppp_jit</span> <span class='op'>=</span> <span class='fu'>rjitter</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_ppp</span>,retry <span class='op'>=</span> <span class='cn'>TRUE</span>,
                                     nsim <span class='op'>=</span> <span class='fl'>1</span>,
                                     drop <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_ppp_jit</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
</div>
<h3 id="kde-2">KDE</h3>
<p>For the KDEs, the following settings are used: + adaptive bandwidth</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_rmType_SG_ppp_jit</span> <span class='op'>=</span> <span class='va'>airbnb_2021_rmType_ppp_jit</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>
<span class='va'>airbnb_2019_rmType_SG_ppp_jit</span> <span class='op'>=</span> <span class='va'>airbnb_2019_rmType_ppp_jit</span><span class='op'>[</span><span class='va'>sg_owin</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_airbnb_2021_rmType_SG_ppp_jit_adaptive</span> <span class='op'>=</span> <span class='fu'>adaptive.density</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_SG_ppp_jit</span>, method<span class='op'>=</span><span class='st'>"kernel"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>kde_airbnb_2021_rmType_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-147-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_airbnb_2019_rmType_SG_ppp_jit_adaptive</span> <span class='op'>=</span> <span class='fu'>adaptive.density</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_SG_ppp_jit</span>, method<span class='op'>=</span><span class='st'>"kernel"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>kde_airbnb_2019_rmType_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-148-1.png" width="624" /></p>
</div>
<p>From the kde plot for Airbnb listing 2021 by room type above, we can see that the density range from 0 to 0.00175. Whereas from the kde plot for Airbnb listing 2019 by room type above, we can see that the density range from 0 to 0.00175.</p>
<p>Converting KDE output into grid object:</p>
<p>Airbnb 2021 (room type)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gridded_kde_airbnb_2021_rmType_SG_ppp_jit_adaptive</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.im</span><span class='op'>(</span><span class='va'>kde_airbnb_2021_rmType_SG_ppp_jit_adaptive</span><span class='op'>)</span>
<span class='fu'>spplot</span><span class='op'>(</span><span class='va'>gridded_kde_airbnb_2021_rmType_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-149-1.png" width="624" /></p>
</div>
<p>Airbnb 2019 (room type)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gridded_kde_airbnb_2019_rmType_SG_ppp_jit_adaptive</span> <span class='op'>&lt;-</span> <span class='fu'>as.SpatialGridDataFrame.im</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_rmType_SG_ppp_jit_adaptive</span><span class='op'>)</span>
<span class='fu'>spplot</span><span class='op'>(</span><span class='va'>gridded_kde_airbnb_2019_rmType_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-150-1.png" width="624" /></p>
</div>
<p>Converting grid output into raster:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_airbnb_2021_rmType_SG_ppp_jit_adaptive_raster</span> <span class='op'>=</span> <span class='fu'>raster</span><span class='op'>(</span><span class='va'>gridded_kde_airbnb_2021_rmType_SG_ppp_jit_adaptive</span><span class='op'>)</span>
<span class='va'>kde_airbnb_2019_rmType_SG_ppp_jit_adaptive_raster</span> <span class='op'>=</span> <span class='fu'>raster</span><span class='op'>(</span><span class='va'>gridded_kde_airbnb_2019_rmType_SG_ppp_jit_adaptive</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kde_airbnb_2021_rmType_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : -6.866509e-21, 0.001716789  (min, max)</code></pre>
</div>
<p>Setting back the crs/projection system information:</p>
<p>Airbnb 2021</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>projection</span><span class='op'>(</span><span class='va'>kde_airbnb_2021_rmType_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+init=EPSG:3414"</span><span class='op'>)</span>
<span class='va'>kde_airbnb_2021_rmType_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs 
source     : memory
names      : v 
values     : -6.866509e-21, 0.001716789  (min, max)</code></pre>
</div>
<p>Airbnb 2019</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>projection</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_rmType_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'>CRS</span><span class='op'>(</span><span class='st'>"+init=EPSG:3414"</span><span class='op'>)</span>
<span class='va'>kde_airbnb_2019_rmType_SG_ppp_jit_adaptive_raster</span>
</code></pre>
</div>
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 417.0614, 264.7348  (x, y)
extent     : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)
crs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs 
source     : memory
names      : v 
values     : -1.172175e-20, 0.001828632  (min, max)</code></pre>
</div>
<p>Displaying the rasters of Airbnb 2019 and 2021 on a map using tmap package</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='va'>airbnb_2019_rmType_raster_map</span> <span class='op'>=</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_rmType_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>airbnb_2021_rmType_raster_map</span> <span class='op'>=</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2021_rmType_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_raster_map</span>,<span class='va'>airbnb_2021_rmType_raster_map</span>,ncol<span class='op'>=</span><span class='fl'>2</span>,nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-155-1.png" width="624" /></p>
</div>
<p>Using openstreetmap as the basemap</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"view"</span><span class='op'>)</span>
<span class='va'>airbnb_2019_rmType_raster_map_osm</span> <span class='op'>=</span> 
<span class='fu'>tm_basemap</span><span class='op'>(</span><span class='st'>"OpenStreetMap"</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_rmType_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span>, palette <span class='op'>=</span> <span class='st'>"Reds"</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>, <span class='st'>"bottom"</span><span class='op'>)</span>, frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>airbnb_2021_rmType_raster_map_osm</span> <span class='op'>=</span> 
  <span class='fu'>tm_basemap</span><span class='op'>(</span><span class='st'>"OpenStreetMap"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2021_rmType_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span>, palette <span class='op'>=</span> <span class='st'>"Blues"</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_raster_map_osm</span>,<span class='va'>airbnb_2021_rmType_raster_map_osm</span>,ncol<span class='op'>=</span><span class='fl'>2</span>,nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<div style="display:inline;width:49%;float:left;border-style:solid;border-color:#BEBEBE;border-width:1px 1px 1px 1px;">
<div id="htmlwidget-6968" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-6968">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAE2ElEQVR4nO2dy3EcIRCGWWkjUQSyjzo4AzkL3x2AA3A8cgY6+KhSBArEVar1aVQjloEG+gX830mPXYaBf7p59DSnAEIIIby/vV6O/nd7d3/SrMtqoHHDsQD34nt/e71AjDIs3ag561cCguRjyYbsEV8MxNjPjXUFtOEUIOBhqadYSoCwhn24bTyuiYCm5YMY23DVaCXB1HayleuFGOtwMybkFgwEOA4uREgVDPfnpLC+/miYPrUcnRUvKPeWxwGsYR1mjeVFMBJAhHWYuOOZBRjC/PdXovb+1Z7YlTomZQmx93yMeKOsJL4QrgVICY6oZStzFlGL3sRqAty4vbs/Ue69RUSpckcXo4slmtnQXkp6f3u9SD/wkuVDhEocWatYQNvvnJ3OVZ6UEOGODSmtcW5uPSfgUvlcwwLJcaiICCE+Xkod39ve1mNKiHAQqEJpafvpRAgB8hK71F6raC24FKwVggBloL5wtf/fSEs5Z+sKgDJ7cdUIyavoYmAJB2QUcVHBOuGAzPawwxIODOfrDpbWFZZwYDh3ViwNCCYmC+DdQ7GZYO83ugJHcYwc5Ugy1Hu9QAdtEWJMCK7QNiwQIUiiKcQuswtXPC+aLrn7PQewDlLChDsGZFxFVsMKrg23RYQIQRccghwi1RrwBbclxJgQmEMWIawgkAKWEFQhsUwDEQJzIEJgDkQIyJjumGBSAiSBJQQkJAMaEN4PsmhE05CzMYH10ArngiVk4PL89PHz6dt3w5rwkUsnEn+mF1hCQCYWJpcIDycmGiloZ+Py/PTJKnrFWxoRsjumZv0Ex8QC1XDdPYI7+q5aPGEsOKvju0YT/ya0WGAvD4/h698/H5+RFmBvihDzd0woZ29wpKjNJX8s5doD/txqK82z4x4LFScE38qJRYlTkK6ZsT1cLNHkjuHybgU1lmdmFN6e5qMJqJ/Nfbd03ZHFycHs4ttoSqBDTbxj1YgSAo0nE9yTi1UEl6I5i1NOiK1ntnF1hAcrqbnjMDpXY0IpV0dZ8vFkTaWZ9b5aaA7lOhIMxVXHn+HuEM0OTu2QQGB1fLKE3BawVB7FfVPcdErkEhY9Hge+PDyGL79/ZOuDpaYyIks0lHGQ5LhNqtPjici2A2JRl5kgnVK+UXMaZO67R+6550RKD5ORIyDCPDch2J+Hy3H93Gb70Vi1l3+/fnIXuSRVSzRciblrqD1gcKPnnOBW9nWF9aPjYtuuREuH5r4jGREE8dWj9rZdySVadV7tgYWS7n1VqoJaWy+y/25u6cQyZjH+W2ryFA8LEGrGw+HsmPPctFR5FCFakGoDr3WdhXMIOlG1lAG7t06N6wyLJ0Ny71i7Ep7Elxou9HgIUMZ0duy1Q3Pj1pWCLLS4auyeBu0JA/MMwrFkuVqiwbgHaMO6TjirVdB6/3ZVhk8Nt7fcklkjpGMgV4a0cFyL9OC9tJAscU0gx/CWsHYmC/yhIkKJ8P39tpkXiwfRtzFNVq6UEDcrqXUfXh6G0RAZE67K/sV8tB+dIeIJPYMJUT/nVVJqSALR9VH9jvDKwM3K4K5B8RCsh6sO7p0kpV46z5UDy+YDN4vV2tkfgB/ciHCmNHKgjqlcUS4cH24XALAGo201AgBAGVi2NXAzO46B+IA5ECEAAAAAAAAAAADW4T/cn3ttcckgRQAAAABJRU5ErkJggg==",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.498039215686275,null,"tmap401","kde_airbnb_2019_rmType_SG_ppp_jit_adaptive_raster"]},{"method":"addLegend","args":[{"colors":["#FDDED0","#FCA082","#F75A40","#CB181D"],"labels":["0.0000 to 0.0005","0.0005 to 0.0010","0.0010 to 0.0015","0.0015 to 0.0020"],"na_color":null,"na_label":"NA","opacity":0.498039215686275,"position":"topright","type":"unknown","title":"v","extra":null,"layerId":"legend401","className":"info legend kde_airbnb_2019_rmType_SG_ppp_jit_adaptive_raster","group":"kde_airbnb_2019_rmType_SG_ppp_jit_adaptive_raster"}]},{"method":"addLayersControl","args":[[],"kde_airbnb_2019_rmType_SG_ppp_jit_adaptive_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.16218335265381,1.47066364891549],"lng":[103.605646858975,104.087962389458]},"fitBounds":[1.1641988317039,103.605646858975,1.4706519681352,104.085357795856,[]]},"evals":[],"jsHooks":[]}</script>
</div>
<div style="display:inline;width:49%;float:left;border-style:solid;border-color:#BEBEBE;border-width:1px 1px 1px 1px;">
<div id="htmlwidget-9172" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-9172">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAABnCAYAAABo4CIfAAAE1klEQVR4nO2du27eOBBG6YUrV6lcpDWQPu+Qfa90+1Ap8gjuA7h14cqVW2+lQOBP8TpDDslzqgSW+FPkpxleRsM7B845517ePj6v/vb0+HDXsy67QeO6awGexffy9vGJGHXYulFj1i8FgpRjy4ZsEZ8PYmznn9EV6I2kAEGGrd5iLQFiDdsw23hSE4Gelg8x1mGq0VKCKe3kUa4XMZZhZkwoLRgEOA8mRJgrGOnrtBj9+7Mx9K2V6Cx/Qbm1PAmwhmUMaywrgtEAEZYxxB2vLEDn1n++FKXP3+2N3aljQpaQvedr1BtlJ/E5dyvAnOCIUo4yVxG16kPsJsCDp8eHu5xnrxFRqNzZxWhiiWY1ei8lvbx9fGq/8JrlI8JOXFkrX0DH/yU7Xao8LSHijgeSWuM83HpMwKnypYYFmuNQFREiPllSHd/a3qPHlIhwEnKFUtP2y4kQAcriu9RWqzhacCFEK4QAdcj94Or8t5mWcu5HVwDSnMVVIiSrovPBEk7ILOLKhXXCCVntZccSTozk5w4jrSuWcGIkd1ZGGhAmJhtg3UOJmWDrD7oDV3GMEuVoMtV3vdCH3iJkTAg39DYsiBCC9BRik9nFFa9LT5fc/J0D7IOWMHHHkI2pyGqs4N5IW0RECE1ICHKKVGtgC2lLyJgQhpMtQqwgaIElhCI0lmkQIQwHEcJwECFkM3THhEkJaIIlhCw0AxoI74coPaJpsrMxwX70CufCEgrw/PrunHPu+9cvg2siRyydiH9NK1hCyMYXppQILycmPVLQrsbz6/tfq2gZa2lEst1xbtZPSNPTfbcI7ureoVE0T48Pd73fImtvbYxDVCFr+OO/38FrtUj11fH3q+uGf2OSc/aGRIraWPLHVK49mOsFjVE9O25xz35C8KMcX5ScgnTLiu1hYokmdgyXdSt4dr1aLnZF4Z2pPpog99rYvanfnVmcEqwuvoOqBDq5iXdGNWIPgT6/votavl0EF6I6i1NMiLVntkl1hAUr2XPHYXZuxoRari7makMTk9B1K7Hqc9VQHcp1JZgcV+1fI90hPTs4tCaIwMrIOpv3itqDXUJ7kC1u60rk0hbdHwf+/PXH/fz3W/QelprSqAS1xvadeyxAa5XtT0RSAjzqggDjFFnCktMgY/e2WK7aEy9Hggjj3Dsne/hzz/vOXLl0ya1GH+llml0pWqKRSsxdQukBgwct5wTXcq4r1i8fE9t2KWo6NBVBcvxbWpCIr5xuX9vlhBb1qkvt76bCn6COoqDW2h853xtbjtG0UDFy1zb9YQGhZjJczo4lz00LlZcjxBGE2sBqXVchODvWaNycAbu1TvXrjMXTIbh33LsSlsQXGi60eAhIM3R2bLVDY+PWnYIsenHT2C0N2hIGZhnCsXS5WaJh3AO9EV0nXNUq9Pr+dlemTw13ttyaWSO0YyB3JmvhuBTtwXtqIVnjN0GP6S1h6UwW7NFFhBrh++dtMysWD9HXsUxWrqt8Kj2fw8rLMBsqY8JdOX+YT/vlM0U8oWWYELVzv0tKDU0QXRvF3wjvDG5WB3MNykuwH6Y6uHWSFMpvGCsHy2YDM4vV0uNSxrnzYEaEK6eRgzhLuaJYOD5uFwD2YLatRgCANFi2PTAzO/ZBfDAcRAgAAAAAAAAA+/A/6mZoOU45hesAAAAASUVORK5CYII=",[[1.47066364891549,103.605646858975],[1.16218335265381,104.087962389458]],0.498039215686275,null,"tmap401","kde_airbnb_2021_rmType_SG_ppp_jit_adaptive_raster"]},{"method":"addLegend","args":[{"colors":["#DDEAF6","#ACD0E6","#5DA5D0","#2171B5"],"labels":["0.0000 to 0.0005","0.0005 to 0.0010","0.0010 to 0.0015","0.0015 to 0.0020"],"na_color":null,"na_label":"NA","opacity":0.498039215686275,"position":"topright","type":"unknown","title":"v","extra":null,"layerId":"legend401","className":"info legend kde_airbnb_2021_rmType_SG_ppp_jit_adaptive_raster","group":"kde_airbnb_2021_rmType_SG_ppp_jit_adaptive_raster"}]},{"method":"addLayersControl","args":[[],"kde_airbnb_2021_rmType_SG_ppp_jit_adaptive_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[1.16218335265381,1.47066364891549],"lng":[103.605646858975,104.087962389458]},"fitBounds":[1.1641988317039,103.605646858975,1.4706519681352,104.085357795856,[]]},"evals":[],"jsHooks":[]}</script>
</div>
<script>
HTMLWidgets.addPostRenderHandler(function() {
var leaf_widgets = {};
                Array.prototype.map.call(
                 document.querySelectorAll(".leaflet"),
                   function(ldiv){
                     if (HTMLWidgets.find("#" + ldiv.id) && HTMLWidgets.find("#" + ldiv.id).getMap()) {
                        leaf_widgets[ldiv.id] = HTMLWidgets.find("#" + ldiv.id).getMap();
                     }
                   }
                );
               
});
</script>
</div>
<p>From the use of openstreetmap above, we are able to tell that most of the similar clusters seem to occur around places like Kallang, tanjong pagar and Peoples Park</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="second-order-spatial-point-patterns-analysis">Second-order Spatial Point Patterns Analysis</h3>
<h4 id="extracting-study-area">Extracting study area</h4>
<p>Plotting the raster on planning subzones to identify subzones with possible cluster of airbnb listing in 2021 by room types</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2021_rmType_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_facets</span><span class='op'>(</span>by <span class='op'>=</span> <span class='st'>"PLN_AREA_N"</span>,
          free.coords <span class='op'>=</span> <span class='cn'>TRUE</span>,
          drop.shapes <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'>tm_borders</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-158-1.png" width="624" /></p>
</div>
<p>From the above plot, we can see that subzones like GEYLANG, ROCHOR and RIVER VALLEY shows signs of clustering, thus we can possibly consider them as possible study areas</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>kde_airbnb_2019_rmType_SG_ppp_jit_adaptive_raster</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_raster</span><span class='op'>(</span><span class='st'>"v"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_3414</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_facets</span><span class='op'>(</span>by <span class='op'>=</span> <span class='st'>"PLN_AREA_N"</span>,
          free.coords <span class='op'>=</span> <span class='cn'>TRUE</span>,
          drop.shapes <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'>tm_borders</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_layout</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>,<span class='st'>"bottom"</span><span class='op'>)</span>,frame <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-159-1.png" width="624" /></p>
</div>
<p>From the above plot, we can see that subzones like GEYLANG, OUTRAM, ROCHOR and RIVER VALLEY shows signs of clustering, thus we can possibly consider them as possible study areas</p>
<p>Out of the 2 plots, the coomon subzones with signs of clusterings are GEYLANG, ROCHOR and RIVER VALLEY, they will thus be our study areas.</p>
<p>Since rochor have already been extracted, extraction will only be done on GEYLANG and RIVER VALLEY</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>geylang</span> <span class='op'>=</span> <span class='va'>mpsz</span><span class='op'>[</span><span class='va'>mpsz</span><span class='op'>@</span><span class='va'>data</span><span class='op'>$</span><span class='va'>PLN_AREA_N</span> <span class='op'>==</span> <span class='st'>"GEYLANG"</span>,<span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>geylang</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-160-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rv</span> <span class='op'>=</span> <span class='va'>mpsz</span><span class='op'>[</span><span class='va'>mpsz</span><span class='op'>@</span><span class='va'>data</span><span class='op'>$</span><span class='va'>PLN_AREA_N</span> <span class='op'>==</span> <span class='st'>"RIVER VALLEY"</span>,<span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rv</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-161-1.png" width="624" /></p>
</div>
<h4 id="converting-the-spatial-polygon-data-frames-into-generic-sp-format">Converting the spatial polygon data frames into generic sp format</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>geylang_sp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>geylang</span>,<span class='st'>"SpatialPolygons"</span><span class='op'>)</span>
<span class='va'>rv_sp</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>rv</span>,<span class='st'>"SpatialPolygons"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="creating-owin-object-1">Creating owin object</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>geylang_owin</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>geylang_sp</span>,<span class='st'>"owin"</span><span class='op'>)</span>
<span class='va'>rv_owin</span> <span class='op'>=</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>rv_sp</span>,<span class='st'>"owin"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="combining-spatial-points-and-the-stuy-areas">Combining spatial points and the stuy areas</h4>
<p>Airbnb 2019</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_rmType_geylang_ppp</span> <span class='op'>=</span> <span class='va'>airbnb_2019_rmType_ppp_jit</span><span class='op'>[</span><span class='va'>geylang_owin</span><span class='op'>]</span>
<span class='va'>airbnb_2019_rmType_rochor_ppp</span> <span class='op'>=</span> <span class='va'>airbnb_2019_rmType_ppp_jit</span><span class='op'>[</span><span class='va'>rochor_owin</span><span class='op'>]</span>
<span class='va'>airbnb_2019_rmType_rv_ppp</span> <span class='op'>=</span> <span class='va'>airbnb_2019_rmType_ppp_jit</span><span class='op'>[</span><span class='va'>rv_owin</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<p>Geylang:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_geylang_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-165-1.png" width="624" /></p>
</div>
<p>First order Spatial Point Patterns Analysis</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_geylang_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-166-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>intensity</span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_geylang_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Entire home/apt    Private room     Shared room 
      83.686299       34.947067        1.451807 </code></pre>
</div>
<p>Rochor</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rochor_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-168-1.png" width="624" /></p>
</div>
<p>First order Spatial Point Patterns Analysis</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rochor_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-169-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>intensity</span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rochor_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Entire home/apt    Private room     Shared room 
      166.84782       122.35507        47.58253 </code></pre>
</div>
<p>River Valley</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rv_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-171-1.png" width="624" /></p>
</div>
<p>First order Spatial Point Patterns Analysis</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rv_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-172-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>intensity</span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rv_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Entire home/apt    Private room     Shared room 
      144.41029        95.59555         2.71193 </code></pre>
</div>
<p>In general, there seems to be higher first order effect for room type: Entire home/apt than the other room types for all subzones in 2019. This could mean that the area promotes Entire home/apt airbnb listings more than other room types.</p>
<p>Airbnb 2021</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_rmType_geylang_ppp</span> <span class='op'>=</span> <span class='va'>airbnb_2021_rmType_ppp_jit</span><span class='op'>[</span><span class='va'>geylang_owin</span><span class='op'>]</span>
<span class='va'>airbnb_2021_rmType_rochor_ppp</span> <span class='op'>=</span> <span class='va'>airbnb_2021_rmType_ppp_jit</span><span class='op'>[</span><span class='va'>rochor_owin</span><span class='op'>]</span>
<span class='va'>airbnb_2021_rmType_rv_ppp</span> <span class='op'>=</span> <span class='va'>airbnb_2021_rmType_ppp_jit</span><span class='op'>[</span><span class='va'>rv_owin</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<p>Geylang:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_geylang_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-175-1.png" width="624" /></p>
</div>
<p>First order Spatial Point Patterns Analysis</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_geylang_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-176-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>intensity</span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_geylang_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Entire home/apt    Private room     Shared room 
      83.790000       35.050767        1.451807 </code></pre>
</div>
<p>Rochor</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rochor_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-178-1.png" width="624" /></p>
</div>
<p>First order Spatial Point Patterns Analysis</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rochor_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-179-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>intensity</span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rochor_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Entire home/apt    Private room     Shared room 
      160.66827       122.97302        47.58253 </code></pre>
</div>
<p>River Valley</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rv_ppp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-181-1.png" width="624" /></p>
</div>
<p>First order Spatial Point Patterns Analysis</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rv_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-182-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>intensity</span><span class='op'>(</span><span class='fu'>rescale</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rv_ppp</span>, <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Entire home/apt    Private room     Shared room 
      144.41029        95.59555         2.71193 </code></pre>
</div>
<p>In general, there seems to be higher first order effect for room type: Entire home/apt than the other room types for all subzones in 2021 as well This could mean that the area promotes Entire home/apt airbnb listings more than other room types in both years and that the changes to first order effect does not seem to be affected by COVID-19.</p>
<h4 id="second-order-multi-type-point-patterns-analysis-cross-l-function">Second-order Multi-type Point Patterns Analysis: Cross L-Function</h4>
<p>In all the KDE plots above for subzones, room type of Entire home/apt has the highest density, followed by Private room and Shared room. Thus we will look at the cross L-function for Entire home/apt vs Private room</p>
<h4 id="constructing-the-hypothesis-statement-1">Constructing the hypothesis statement</h4>
<p>Perfroming CSR testing on the Cross L-Function</p>
<p>Airbnb 2019 room types:</p>
<ol type="1">
<li>Airbnb Listings 2019 room type (geylang)</li>
</ol>
<p>The hypothesis and test are as follows:</p>
<p>Ho = The distribution of Airbnb Listings 2019 room types, Entire home/apt and Private rooms, in subzone geylang, are spatially independent.</p>
<p>H1= The distribution of Airbnb Listings 2019 room types, Entire home/apt and Private rooms, in subzone geylang, are NOT at spatially independent.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001 (i.e.at 99.9% confident interval).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_rmType_geylang_Lcross</span> <span class='op'>&lt;-</span> <span class='fu'>Lcross</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_geylang_ppp</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_geylang_Lcross</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, 
     xlab <span class='op'>=</span> <span class='st'>"distance(m)"</span>, 
     xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-184-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>airbnb_2019_rmType_geylang_Lcross.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_geylang_ppp</span>, <span class='va'>Lcross</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>999</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60
.........70.........80.........90.........100.........110.........120
.........130.........140.........150.........160.........170.........180
.........190.........200.........210.........220.........230.........240
.........250.........260.........270.........280.........290.........300
.........310.........320.........330.........340.........350.........360
.........370.........380.........390.........400.........410.........420
.........430.........440.........450.........460.........470.........480
.........490.........500.........510.........520.........530.........540
.........550.........560.........570.........580.........590.........600
.........610.........620.........630.........640.........650.........660
.........670.........680.........690.........700.........710.........720
.........730.........740.........750.........760.........770.........780
.........790.........800.........810.........820.........830.........840
.........850.........860.........870.........880.........890.........900
.........910.........920.........930.........940.........950.........960
.........970.........980.........990........ 999.

Done.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_geylang_Lcross.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-186-1.png" width="624" /></p>
</div>
<p>Based on the plot above for cross L-function, we know that the distribution of Airbnb listing in 2019 room types, Entire home/apt and Private rooms, in geylang, are not spatially independent, we can also reject the null hypothesis since the empirical l-cross line is beyond the envelop of the 99.9% confidence interval.</p>
<ol start="2" type="1">
<li>Airbnb Listings 2019 room type (rochor)</li>
</ol>
<p>The hypothesis and test are as follows:</p>
<p>Ho = The distribution of Airbnb Listings 2019 room types, Entire home/apt and Private rooms, in subzone rochor, are spatially independent.</p>
<p>H1= The distribution of Airbnb Listings 2019 room types, Entire home/apt and Private rooms, in subzone rochor, are NOT at spatially independent.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001 (i.e.at 99.9% confident interval).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_rmType_rochor_Lcross</span> <span class='op'>&lt;-</span> <span class='fu'>Lcross</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rochor_ppp</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rochor_Lcross</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, 
     xlab <span class='op'>=</span> <span class='st'>"distance(m)"</span>, 
     xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-187-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>airbnb_2019_rmType_rochor_Lcross.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rochor_ppp</span>, <span class='va'>Lcross</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>999</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60
.........70.........80.........90.........100.........110.........120
.........130.........140.........150.........160.........170.........180
.........190.........200.........210.........220.........230.........240
.........250.........260.........270.........280.........290.........300
.........310.........320.........330.........340.........350.........360
.........370.........380.........390.........400.........410.........420
.........430.........440.........450.........460.........470.........480
.........490.........500.........510.........520.........530.........540
.........550.........560.........570.........580.........590.........600
.........610.........620.........630.........640.........650.........660
.........670.........680.........690.........700.........710.........720
.........730.........740.........750.........760.........770.........780
.........790.........800.........810.........820.........830.........840
.........850.........860.........870.........880.........890.........900
.........910.........920.........930.........940.........950.........960
.........970.........980.........990........ 999.

Done.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rochor_Lcross.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-189-1.png" width="624" /></p>
</div>
<p>Based on the plot above for cross L-function, we know that the distribution of Airbnb listing in 2019 room types, Entire home/apt and Private rooms, in rochor, are not spatially independent, however, we cannot reject the null hypothesis since the empirical l-cross line is within the envelop of the 99.9% confidence interval.</p>
<ol start="3" type="1">
<li>Airbnb Listings 2019 room type (river valley)</li>
</ol>
<p>The hypothesis and test are as follows:</p>
<p>Ho = The distribution of Airbnb Listings 2019 room types, Entire home/apt and Private rooms, in subzone river valley, are spatially independent.</p>
<p>H1= The distribution of Airbnb Listings 2019 room types, Entire home/apt and Private rooms, in subzone river valley, are NOT at spatially independent.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001 (i.e.at 99.9% confident interval).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2019_rmType_rv_Lcross</span> <span class='op'>&lt;-</span> <span class='fu'>Lcross</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rv_ppp</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rv_Lcross</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, 
     xlab <span class='op'>=</span> <span class='st'>"distance(m)"</span>, 
     xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-190-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>airbnb_2019_rmType_rv_Lcross.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rv_ppp</span>, <span class='va'>Lcross</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>999</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60
.........70.........80.........90.........100.........110.........120
.........130.........140.........150.........160.........170.........180
.........190.........200.........210.........220.........230.........240
.........250.........260.........270.........280.........290.........300
.........310.........320.........330.........340.........350.........360
.........370.........380.........390.........400.........410.........420
.........430.........440.........450.........460.........470.........480
.........490.........500.........510.........520.........530.........540
.........550.........560.........570.........580.........590.........600
.........610.........620.........630.........640.........650.........660
.........670.........680.........690.........700.........710.........720
.........730.........740.........750.........760.........770.........780
.........790.........800.........810.........820.........830.........840
.........850.........860.........870.........880.........890.........900
.........910.........920.........930.........940.........950.........960
.........970.........980.........990........ 999.

Done.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2019_rmType_rv_Lcross.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-192-1.png" width="624" /></p>
</div>
<p>Based on the plot above for cross L-function, we know that the distribution of Airbnb listing in 2019 room types, Entire home/apt and Private rooms, in river valley, are not spatially independent, we can also reject the null hypothesis since the empirical l-cross line is beyond the envelop of the 99.9% confidence interval.</p>
<p>Airbnb 2021 room types:</p>
<ol type="1">
<li>Airbnb Listings 2021 room type (geylang)</li>
</ol>
<p>The hypothesis and test are as follows:</p>
<p>Ho = The distribution of Airbnb Listings 2021 room types, Entire home/apt and Private rooms, in subzone geylang, are spatially independent.</p>
<p>H1= The distribution of Airbnb Listings 2021 room types, Entire home/apt and Private rooms, in subzone geylang, are NOT at spatially independent.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001 (i.e.at 99.9% confident interval).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_rmType_geylang_Lcross</span> <span class='op'>&lt;-</span> <span class='fu'>Lcross</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_geylang_ppp</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_geylang_Lcross</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, 
     xlab <span class='op'>=</span> <span class='st'>"distance(m)"</span>, 
     xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-193-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>airbnb_2021_rmType_geylang_Lcross.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_geylang_ppp</span>, <span class='va'>Lcross</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>999</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60
.........70.........80.........90.........100.........110.........120
.........130.........140.........150.........160.........170.........180
.........190.........200.........210.........220.........230.........240
.........250.........260.........270.........280.........290.........300
.........310.........320.........330.........340.........350.........360
.........370.........380.........390.........400.........410.........420
.........430.........440.........450.........460.........470.........480
.........490.........500.........510.........520.........530.........540
.........550.........560.........570.........580.........590.........600
.........610.........620.........630.........640.........650.........660
.........670.........680.........690.........700.........710.........720
.........730.........740.........750.........760.........770.........780
.........790.........800.........810.........820.........830.........840
.........850.........860.........870.........880.........890.........900
.........910.........920.........930.........940.........950.........960
.........970.........980.........990........ 999.

Done.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_geylang_Lcross.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-195-1.png" width="624" /></p>
</div>
<p>Based on the plot above for cross L-function, we know that the distribution of Airbnb listing in 2021 room types, Entire home/apt and Private rooms, in geylang, are not spatially independent, we can also reject the null hypothesis since the empirical l-cross line is beyond the envelop of the 99.9% confidence interval.</p>
<ol start="2" type="1">
<li>Airbnb Listings 2021 room type (rochor)</li>
</ol>
<p>The hypothesis and test are as follows:</p>
<p>Ho = The distribution of Airbnb Listings 2021 room types, Entire home/apt and Private rooms, in subzone rochor, are spatially independent.</p>
<p>H1= The distribution of Airbnb Listings 2021 room types, Entire home/apt and Private rooms, in subzone rochor, are NOT at spatially independent.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001 (i.e.at 99.9% confident interval).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_rmType_rochor_Lcross</span> <span class='op'>&lt;-</span> <span class='fu'>Lcross</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rochor_ppp</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rochor_Lcross</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, 
     xlab <span class='op'>=</span> <span class='st'>"distance(m)"</span>, 
     xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-196-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>airbnb_2021_rmType_rochor_Lcross.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rochor_ppp</span>, <span class='va'>Lcross</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>999</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60
.........70.........80.........90.........100.........110.........120
.........130.........140.........150.........160.........170.........180
.........190.........200.........210.........220.........230.........240
.........250.........260.........270.........280.........290.........300
.........310.........320.........330.........340.........350.........360
.........370.........380.........390.........400.........410.........420
.........430.........440.........450.........460.........470.........480
.........490.........500.........510.........520.........530.........540
.........550.........560.........570.........580.........590.........600
.........610.........620.........630.........640.........650.........660
.........670.........680.........690.........700.........710.........720
.........730.........740.........750.........760.........770.........780
.........790.........800.........810.........820.........830.........840
.........850.........860.........870.........880.........890.........900
.........910.........920.........930.........940.........950.........960
.........970.........980.........990........ 999.

Done.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rochor_Lcross.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-198-1.png" width="624" /></p>
</div>
<p>Based on the plot above for cross L-function, we know that the distribution of Airbnb listing in 2021 room types, Entire home/apt and Private rooms, in rochor, are not spatially independent, however, we cannot reject the null hypothesis since the empirical l-cross line is within the envelop of the 99.9% confidence interval.</p>
<ol start="3" type="1">
<li>Airbnb Listings 2021 room type (river valley)</li>
</ol>
<p>The hypothesis and test are as follows:</p>
<p>Ho = The distribution of Airbnb Listings 2021 room types, Entire home/apt and Private rooms, in subzone river valley, are spatially independent.</p>
<p>H1= The distribution of Airbnb Listings 2021 room types, Entire home/apt and Private rooms, in subzone river valley, are NOT at spatially independent.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001 (i.e.at 99.9% confident interval).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>airbnb_2021_rmType_rv_Lcross</span> <span class='op'>&lt;-</span> <span class='fu'>Lcross</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rv_ppp</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rv_Lcross</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, 
     xlab <span class='op'>=</span> <span class='st'>"distance(m)"</span>, 
     xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-199-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>airbnb_2021_rmType_rv_Lcross.csr</span> <span class='op'>&lt;-</span> <span class='fu'>envelope</span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rv_ppp</span>, <span class='va'>Lcross</span>, i<span class='op'>=</span><span class='st'>"Entire home/apt"</span>, j<span class='op'>=</span><span class='st'>"Private room"</span>, correction<span class='op'>=</span><span class='st'>'border'</span>, nsim<span class='op'>=</span><span class='fl'>999</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Generating 999 simulations of CSR  ...
1, 2, 3, ......10.........20.........30.........40.........50.........60
.........70.........80.........90.........100.........110.........120
.........130.........140.........150.........160.........170.........180
.........190.........200.........210.........220.........230.........240
.........250.........260.........270.........280.........290.........300
.........310.........320.........330.........340.........350.........360
.........370.........380.........390.........400.........410.........420
.........430.........440.........450.........460.........470.........480
.........490.........500.........510.........520.........530.........540
.........550.........560.........570.........580.........590.........600
.........610.........620.........630.........640.........650.........660
.........670.........680.........690.........700.........710.........720
.........730.........740.........750.........760.........770.........780
.........790.........800.........810.........820.........830.........840
.........850.........860.........870.........880.........890.........900
.........910.........920.........930.........940.........950.........960
.........970.........980.........990........ 999.

Done.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>airbnb_2021_rmType_rv_Lcross.csr</span>, <span class='va'>.</span> <span class='op'>-</span><span class='va'>r</span> <span class='op'>~</span> <span class='va'>r</span>, xlab<span class='op'>=</span><span class='st'>"distance(m)"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-2_files/figure-html5/unnamed-chunk-201-1.png" width="624" /></p>
</div>
<p>Based on the plot above for cross L-function, we know that the distribution of Airbnb listing in 2021 room types, Entire home/apt and Private rooms, in river valley, are not spatially independent, we can also reject the null hypothesis since the empirical l-cross line is beyond the envelop of the 99.9% confidence interval.</p>
<h3 id="conclusion">Conclusion</h3>
<p>In conclusion, the 2nd order spatial point patterns analysis indicates that room types of both year seems to be largely unchanged even with covid-19.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
